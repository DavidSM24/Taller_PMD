"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1743],{1743:(v,g,s)=>{s.r(g),s.d(g,{UserCreatePageModule:()=>_});var d=s(6019),a=s(9010),n=s(2651),u=s(8725),l=s(4762),e=s(865),m=s(7524),Z=s(9574),p=s(7639),h=s(371);function f(t,c){if(1&t){const o=e.EpF();e.TgZ(0,"ion-button",32),e.NdJ("click",function(){return e.CHM(o),e.oxw(2).showPicker()}),e._uU(1," Seleccionar "),e.qZA()}}function A(t,c){if(1&t){const o=e.EpF();e.TgZ(0,"ion-button",32),e.NdJ("click",function(){return e.CHM(o),e.oxw(2).showPicker()}),e._uU(1),e.qZA()}if(2&t){const o=e.oxw(2);e.xp6(1),e.hij(" ",o.insurance.cia_Name," ")}}function T(t,c){if(1&t){const o=e.EpF();e.TgZ(0,"form",22),e.TgZ(1,"div",23),e.TgZ(2,"ion-grid"),e.TgZ(3,"h2"),e._uU(4,"Datos de la Agencia"),e.qZA(),e.TgZ(5,"ion-row",6),e.TgZ(6,"ion-col",7),e.TgZ(7,"ion-label"),e._uU(8,"C\xf3digo Zip:"),e.qZA(),e.qZA(),e.TgZ(9,"ion-col",8),e._UZ(10,"ion-input",24),e.qZA(),e.qZA(),e.TgZ(11,"ion-row",6),e.TgZ(12,"ion-col",7),e.TgZ(13,"ion-label"),e._uU(14,"Direcci\xf3n:"),e.qZA(),e.qZA(),e.TgZ(15,"ion-col",8),e._UZ(16,"ion-input",25),e.qZA(),e.qZA(),e.TgZ(17,"ion-row",6),e.TgZ(18,"ion-col",7),e.TgZ(19,"ion-label"),e._uU(20,"Localidad:"),e.qZA(),e.qZA(),e.TgZ(21,"ion-col",8),e._UZ(22,"ion-input",26),e.qZA(),e.qZA(),e.TgZ(23,"ion-row",6),e.TgZ(24,"ion-col",7),e.TgZ(25,"ion-label"),e._uU(26,"N\xfamero de Tel\xe9fono:"),e.qZA(),e.qZA(),e.TgZ(27,"ion-col",8),e._UZ(28,"ion-input",27),e.qZA(),e.qZA(),e.TgZ(29,"ion-row",6),e.TgZ(30,"ion-col",28),e._uU(31," Activa: "),e.qZA(),e.TgZ(32,"ion-col",29),e.TgZ(33,"ion-item",17),e.NdJ("click",function(){return e.CHM(o),e.oxw().changeActive()}),e._uU(34," No"),e._UZ(35,"ion-toggle"),e._uU(36,"Si "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"ion-row",6),e.TgZ(38,"ion-col",30),e.TgZ(39,"ion-label"),e._uU(40,"Compa\xf1\xeda de Seguros:"),e.qZA(),e.qZA(),e.TgZ(41,"ion-col",30),e.YNc(42,f,2,0,"ion-button",31),e.YNc(43,A,2,1,"ion-button",31),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const o=e.oxw();e.Q6J("formGroup",o.formAgency),e.xp6(42),e.Q6J("ngIf",null==o.insurance),e.xp6(1),e.Q6J("ngIf",null!=o.insurance)}}const U=[{path:"",component:(()=>{class t{constructor(o,i,r,C,b,y){this.usserv=o,this.as=i,this.is=r,this.fb=C,this.uts=b,this.pickerController=y,this.admin=!1,this.active=!1,this.insurance=null,this.formUser=this.fb.group({code:["",a.kI.required],password:["",a.kI.required],email:["",a.kI.required],name:["",a.kI.required]}),this.formAgency=this.fb.group({zipCode:["",a.kI.required],address:["",a.kI.required],location:["",a.kI.required],phoneNumber:["",a.kI.required]})}ionViewWillEnter(){return(0,l.mG)(this,void 0,void 0,function*(){yield this.uts.presentLoading(),this.companies=[],this.companies=yield this.is.getAll(),this.companies.length<=0&&(this.uts.presentToast("Para crear agencias, deben existir compa\xf1\xedas de seguros. Solo podr\xe1 crear usuarios administradores.","danger","ban"),this.admin=!0,this.toggle.checked=!0,this.toggle.disabled=!0),yield this.uts.hideLoading()})}CreateUser(){return(0,l.mG)(this,void 0,void 0,function*(){yield this.uts.presentLoading();let o=yield this.usserv.getByCode(this.formUser.get("code").value);if(yield this.uts.hideLoading(),o)this.uts.presentToast("Ya existe un usuario con ese c\xf3digo, prueba con otro diferente.","danger","ban");else{yield this.uts.presentLoading();try{let i={code:this.formUser.get("code").value,password:this.formUser.get("password").value,administrator:this.admin,email:this.formUser.get("email").value,name:this.formUser.get("name").value};try{if(i=yield this.usserv.createOrUpdate(i),this.admin&&this.uts.presentToast("Usuario agregado correctamente","success","checkmark-circle-outline"),this.formUser.reset(),!this.admin&&null!=this.insurance){let r={zipCode:this.formAgency.get("zipCode").value,address:this.formAgency.get("address").value,location:this.formAgency.get("location").value,phoneNumber:this.formAgency.get("phoneNumber").value,amount:0,points:0,pointsRedeemed:0,myInsuranceCompany:this.insurance,myCarRepairs:[],myExchangesGifts:[],myUser:i,active:this.active};console.log(r),r=yield this.as.createOrUpdate(r),this.as.added=!0,r.id?(this.formAgency.reset(),this.uts.presentToast("La agencia se ha creado correctamente.","success","checkmark-circle-outline")):this.uts.presentToast("Un error ha surgido al intentar crear la agencia.","danger","ban")}}catch(r){this.uts.presentToast("Ha habido un error al crear el usuario. Compruebe longitud: c\xf3digo (<=3), contrase\xf1a: (<=10).","danger","ban")}}catch(i){yield this.uts.hideLoading(),console.log(i)}yield this.uts.hideLoading()}})}showPicker(){return(0,l.mG)(this,void 0,void 0,function*(){let o={buttons:[{text:"Cancel",role:"cancel"},{text:"Ok",handler:r=>{this.insurance=r.Compa\u00f1\u00edas.value}}],columns:[{name:"Compa\xf1\xedas",options:this.getColumnOptions()}]};(yield this.pickerController.create(o)).present()})}getColumnOptions(){let o=[];return this.companies.forEach(i=>{o.push({text:i.cia_Name,value:i})}),o}changeAdmin(){this.admin=!this.admin}changeActive(){this.active=!this.active}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(m.K),e.Y36(Z.Y),e.Y36(p.r),e.Y36(a.qu),e.Y36(h.f),e.Y36(n.up))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-user-create"]],viewQuery:function(o,i){if(1&o&&e.Gf(n.ho,5),2&o){let r;e.iGM(r=e.CRH())&&(i.toggle=r.first)}},decls:55,vars:5,consts:[[3,"translucent"],["color","primary"],[3,"fullscreen"],[1,"body"],[1,"ion-padding",3,"formGroup"],[1,"formulario"],[1,"ion-align-items-center"],["size","1.3"],["size","10.7"],["type","number","formControlName","code",1,"customInput"],["type","password","formControlName","password",1,"customInput"],["type","text","formControlName","email",1,"customInput"],["type","text","formControlName","name",1,"customInput"],[1,"ion-padding"],[1,"formulario",2,"margin-top","-0.5% !important","margin-left","1.5%","margin-right","1.5%"],["sizeSm","10","sizeLg","2"],["sizeSm","2","sizeLg","11  "],["lines","none",3,"click"],["style","margin-top: -2% !important;",3,"formGroup",4,"ngIf"],["size","6"],["expand","block","shape","round","routerLink","/tab-administrator/agency/list",1,"button"],["expand","block","shape","round",1,"button",2,"margin-top","2% !important",3,"disabled","click"],[2,"margin-top","-2% !important",3,"formGroup"],[2,"margin-bottom","0% !important"],["type","number","formControlName","zipCode",1,"customInput"],["type","text","formControlName","address",1,"customInput"],["type","text","formControlName","location",1,"customInput"],["type","number","formControlName","phoneNumber",1,"customInput"],["sizeSm","9","sizeLg","1"],["sizeSm","3","sizeLg","11  "],["sizeSm","2","sizeLg","2"],["expand","block","shape","round",3,"click",4,"ngIf"],["expand","block","shape","round",3,"click"]],template:function(o,i){1&o&&(e.TgZ(0,"ion-header",0),e.TgZ(1,"ion-toolbar",1),e.TgZ(2,"ion-title"),e._uU(3," Creacion de Usuario "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(4,"ion-content",2),e.TgZ(5,"div",3),e.TgZ(6,"form",4),e.TgZ(7,"div",5),e.TgZ(8,"ion-grid"),e.TgZ(9,"h2"),e._uU(10,"Datos del Usuario"),e.qZA(),e.TgZ(11,"ion-row",6),e.TgZ(12,"ion-col",7),e.TgZ(13,"ion-label"),e._uU(14,"Code:"),e.qZA(),e.qZA(),e.TgZ(15,"ion-col",8),e._UZ(16,"ion-input",9),e.qZA(),e.qZA(),e.TgZ(17,"ion-row",6),e.TgZ(18,"ion-col",7),e.TgZ(19,"ion-label"),e._uU(20,"Contrase\xf1a:"),e.qZA(),e.qZA(),e.TgZ(21,"ion-col",8),e._UZ(22,"ion-input",10),e.qZA(),e.qZA(),e.TgZ(23,"ion-row",6),e.TgZ(24,"ion-col",7),e.TgZ(25,"ion-label"),e._uU(26,"Email:"),e.qZA(),e.qZA(),e.TgZ(27,"ion-col",8),e._UZ(28,"ion-input",11),e.qZA(),e.qZA(),e.TgZ(29,"ion-row",6),e.TgZ(30,"ion-col",7),e.TgZ(31,"ion-label"),e._uU(32,"Name:"),e.qZA(),e.qZA(),e.TgZ(33,"ion-col",8),e._UZ(34,"ion-input",12),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(35,"div",13),e.TgZ(36,"div",14),e.TgZ(37,"ion-row",6),e.TgZ(38,"ion-col",15),e._uU(39," Administrador: "),e.qZA(),e.TgZ(40,"ion-col",16),e.TgZ(41,"ion-item",17),e.NdJ("click",function(){return i.changeAdmin()}),e._uU(42," No"),e._UZ(43,"ion-toggle"),e._uU(44,"Si "),e.qZA(),e.qZA(),e.qZA(),e._UZ(45,"br"),e.YNc(46,T,44,3,"form",18),e.TgZ(47,"ion-grid"),e.TgZ(48,"ion-row"),e.TgZ(49,"ion-col",19),e.TgZ(50,"ion-button",20),e._uU(51," Cancelar "),e.qZA(),e.qZA(),e.TgZ(52,"ion-col",19),e.TgZ(53,"ion-button",21),e.NdJ("click",function(){return i.CreateUser()}),e._uU(54," Crear "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(2),e.Q6J("formGroup",i.formUser),e.xp6(40),e.Q6J("ngIf",!i.admin),e.xp6(7),e.Q6J("disabled",!i.admin&&i.formAgency.invalid||i.formUser.invalid||!i.admin&&i.formAgency.invalid||!i.admin&&null==i.insurance))},directives:[n.Gu,n.sr,n.wd,n.W2,a._Y,a.JL,a.sg,n.jY,n.Nd,n.wI,n.Q$,n.pK,n.as,a.JJ,a.u,n.j9,n.Ie,n.ho,n.w,d.O5,n.YG,n.YI,u.rH],styles:['.body[_ngcontent-%COMP%]{background:#717499;background-size:cover;min-height:100%}.button[_ngcontent-%COMP%]{--background: #22388c}.admincss[_ngcontent-%COMP%]{margin-left:1.5%;margin-right:1.5%;border-top:2px double gray;border:1px solid;border-color:"primary";border-radius:2.5rem;background-color:#fff}']}),t})()}];let q=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[u.Bz.forChild(U)],u.Bz]}),t})(),_=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[d.ez,a.u5,n.Pc,q,a.UX]]}),t})()}}]);