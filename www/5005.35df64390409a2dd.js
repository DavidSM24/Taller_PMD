"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5005],{5005:(U,g,s)=>{s.r(g),s.d(g,{CarRepairListPageModule:()=>w});var p=s(6019),u=s(9010),a=s(2651),h=s(8725),c=s(4762),m=s(9600),f=s(5744),e=s(865),_=s(7928),Z=s(371),y=s(9574),C=s(9311);function v(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"ion-text",35),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw().edit(n)}),e._UZ(1,"ion-icon",36),e.qZA()}}function R(o,l){1&o&&e._UZ(0,"ion-icon",37)}function x(o,l){1&o&&e._UZ(0,"ion-icon",38)}function T(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"ion-text",39),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw().showDeleteMenu(n)}),e._UZ(1,"ion-icon",40),e.qZA()}}function S(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"ion-row",25),e.TgZ(1,"ion-col",26),e.YNc(2,v,2,0,"ion-text",27),e.qZA(),e.TgZ(3,"ion-col",28),e.NdJ("click",function(){const r=e.CHM(i).$implicit;return e.oxw().saw(r)}),e.TgZ(4,"ion-text",29),e._uU(5),e.qZA(),e.qZA(),e.TgZ(6,"ion-col",28),e.NdJ("click",function(){const r=e.CHM(i).$implicit;return e.oxw().saw(r)}),e.TgZ(7,"ion-text",29),e._uU(8),e.qZA(),e.qZA(),e.TgZ(9,"ion-col",28),e.NdJ("click",function(){const r=e.CHM(i).$implicit;return e.oxw().saw(r)}),e.TgZ(10,"ion-text",29),e._uU(11),e.qZA(),e.qZA(),e.TgZ(12,"ion-col",28),e.NdJ("click",function(){const r=e.CHM(i).$implicit;return e.oxw().saw(r)}),e.TgZ(13,"div",30),e.YNc(14,R,1,0,"ion-icon",31),e.qZA(),e.TgZ(15,"div",32),e.YNc(16,x,1,0,"ion-icon",33),e.qZA(),e.qZA(),e.TgZ(17,"ion-col",26),e.YNc(18,T,2,0,"ion-text",34),e.qZA(),e.qZA()}if(2&o){const i=l.$implicit;e.xp6(2),e.Q6J("ngIf",!i.repaired),e.xp6(3),e.hij(" ",i.carPlate.toUpperCase()," "),e.xp6(3),e.hij(" ",i.dateOrder," "),e.xp6(3),e.hij(" ",i.amount," "),e.xp6(3),e.Q6J("ngIf",i.repaired),e.xp6(2),e.Q6J("ngIf",!i.repaired),e.xp6(2),e.Q6J("ngIf",!i.repaired)}}const A=[{path:"",component:(()=>{class o{constructor(i,t,n,r,d,b,M,q,z,O){this.cS=i,this.toast=t,this.alertCtrl=n,this.modalCtrl=r,this.loading=d,this.utilService=b,this.agencyService=M,this.routes=q,this.pt=z,this.authService=O,this.n=0,this.carRepairs=[],this.carRepairsStore=[],this.searchStr=""}ngOnInit(){}ionViewWillEnter(){return(0,c.mG)(this,void 0,void 0,function*(){})}ionViewDidEnter(){return(0,c.mG)(this,void 0,void 0,function*(){if(this.cS.added)this.reset(null),this.cS.added=!1;else try{yield this.getMyAgency(),this.nItems=Math.ceil(this.pt.height()/20+10),yield this.loadCarRepair(),this.n=this.carRepairs.length}catch(i){}})}loadCarRepair(i){return(0,c.mG)(this,void 0,void 0,function*(){let t=[];if(0==this.carRepairs.length){i||this.presentLoading(),this.infinite.disabled=!1;try{t=yield this.cS.getByAgencyPaged(this.myAgency.id,this.nItems,0),this.carRepairs=this.carRepairs.concat(t),this.storageCarRepairs(),t.length<this.nItems&&(this.infinite.disabled=!0)}catch(n){this.presentToast("Error de carga","danger","ban")}finally{i?i.target.complete():this.loading.dismiss()}}})}edit(i){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:f.K,cssClass:"fullscreen",componentProps:{carRepair:i}});yield t.present();const n=yield t.onDidDismiss();if(null!=n.data){let r=this.carRepairs.indexOf(i);this.carRepairs[r]=n.data.newCarRepair}})}delete(i){return(0,c.mG)(this,void 0,void 0,function*(){try{yield this.presentLoading();const t=yield this.cS.delete(i);let n=this.carRepairs.indexOf(i,0);t?(n>-1&&this.carRepairs.splice(n,1),this.presentToast("La reparaci\xf3n ha sido eliminada correctamente.","success","checkmark-circle-outline")):this.presentToast("Error al borrar la reparaci\xf3n","danger","ban")}catch(t){this.presentToast("Nose ha podido borrar la reparaci\xf3n, intentelo m\xe1s tarde","danger","ban")}finally{try{yield this.miLoading.dismiss()}catch(t){}}})}showDeleteMenu(i){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.alertCtrl.create({header:"Confirmaci\xf3n",message:"\xbfDesea eliminar la reparaci\xf3n?",buttons:[{text:"Eliminar",cssClass:"rojo",handler:()=>{this.delete(i)}},{text:"Cancelar",cssClass:"secundary",role:"cancel"}]});try{yield t.present()}catch(n){}})}saw(i){return(0,c.mG)(this,void 0,void 0,function*(){return yield(yield this.modalCtrl.create({component:m.T,cssClass:"my-modal-class",componentProps:{carRepair:i}})).present()})}setCarByStatus(i){return(0,c.mG)(this,void 0,void 0,function*(){let t=[];const n=i.detail.value;try{if(yield this.utilService.presentLoading(),"false".match(n)){let r=yield this.cS.getByStatedPaged(!1,9999,0);t=this.addSearchedReparation(r,t),this.carRepairs=t}else if("true".match(n)){let r=yield this.cS.getByStatedPaged(!0,9999,0);t=this.addSearchedReparation(r,t),this.carRepairs=t}else"all".match(n)&&this.reset()}catch(r){}finally{yield this.utilService.hideLoading()}})}onSearchChange(i){return(0,c.mG)(this,void 0,void 0,function*(){let t=[],n=[];this.searchStr=i.detail.value;let r=new RegExp("^[ ]");if(this.searchStr.match(r))this.presentToast("La b\xfasqueda no puede comenzar por espacios en blanco.","danger","ban");else if(this.searchStr.length>0)try{this.carRepairs=[],yield this.utilService.presentLoading(),n=yield this.cS.getByOperationFilter(this.searchStr),t=this.addSearchedReparation(n,t),n=yield this.cS.getByCarPlate(this.searchStr,9999,0),t=this.addSearchedReparation(n,t),n=yield this.cS.getByClientName(this.searchStr,9999,0),t=this.addSearchedReparation(n,t),n=yield this.cS.getByAgencyInfoFilter(this.searchStr),t=this.addSearchedReparation(n,t),this.carRepairs=t}catch(d){yield this.utilService.presentToast("Se ha producido un error en la busqueda","danger","ban")}finally{yield this.utilService.hideLoading()}else if(length<1)try{yield this.reset()}catch(d){}})}addSearchedReparation(i,t){let n;return i.forEach(r=>{n=!0,this.myAgency.id==r.myAgency.id&&(t.forEach(d=>{d.id==r.id&&(n=!1)}),n&&t.push(r))}),t}reset(i){return(0,c.mG)(this,void 0,void 0,function*(){this.n=0,this.infinite.disabled=!1,this.carRepairs=[],this.loadCarRepair(i)})}storageCarRepairs(){this.carRepairsStore=this.carRepairs}logout(){this.authService.logout()}getMyAgency(){return(0,c.mG)(this,void 0,void 0,function*(){let i;try{yield this.utilService.presentLoading(),i=this.authService.agency,this.myAgency=this.authService.agency,this.idAgency=this.authService.agency.id,yield this.utilService.hideLoading()}catch(t){yield this.utilService.presentToast("Fallo al cargar","danger","ban"),yield this.utilService.hideLoading()}})}infiniteLoad(i){return(0,c.mG)(this,void 0,void 0,function*(){let t=[];if(!this.infinite.disabled)try{t=yield this.cS.getByAgencyPaged(this.myAgency.id,this.nItems,this.carRepairs.length),this.carRepairs=this.carRepairs.concat(t),t.length<30&&(this.infinite.disabled=!0)}catch(n){}this.infinite.complete()})}presentLoading(){return(0,c.mG)(this,void 0,void 0,function*(){this.miLoading=yield this.loading.create({message:""}),yield this.miLoading.present()})}presentToast(i,t,n){return(0,c.mG)(this,void 0,void 0,function*(){(yield this.toast.create({message:i,duration:2e3,color:t,icon:n})).present()})}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(_.K),e.Y36(a.yF),e.Y36(a.Br),e.Y36(a.IN),e.Y36(a.HT),e.Y36(Z.f),e.Y36(y.Y),e.Y36(h.F0),e.Y36(a.t4),e.Y36(C.e))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-car-repair-list"]],viewQuery:function(i,t){if(1&i&&e.Gf(a.ju,5),2&i){let n;e.iGM(n=e.CRH())&&(t.infinite=n.first)}},decls:49,vars:3,consts:[[3,"translucent"],["color","medium"],["slot","end",2,"margin-right","1%"],["title","Nuevo","routerLink","/tab-user/car-repair/create",1,"icon-div-container"],["slot","end",1,"icon-logout",2,"color","white","pointer-events","none","zoom","1.5","cursor","pointer","content","url(../../../../assets/icon/new_icon_ui.png)"],["title","Cerrar Sesi\xf3n",1,"icon-div-container",3,"click"],["slot","end","name","log-out-outline",1,"icon-logout",2,"zoom","1.7","cursor","pointer"],["sizeSm","12","size","9","sizeMd","12","sizeLg","9",2,"border","none !important"],["placeholder","Encuentra la reparaci\xf3n que est\xe1s buscando...","inputmode","text","type","text","debounce","1000","showCancelButton","always",3,"ionChange"],["sizeMd","3","sizeSm","3","sizeLg","3",1,"selector",2,"border","none !important"],[2,"height","85%","margin-top","1.1%"],["interface","popover","multiple","false",3,"ionChange"],["value","true"],["value","false"],["value","all"],[1,"header-row"],["sizeSm","1","sizeLg","1",2,"border","0px !important"],["sizeSm","2.5","sizeLg","2.5",2,"border","0px !important"],[2,"background-color","white",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"body"],[1,"ion-text-center"],["let","","class","row",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText",""],["let","",1,"row"],["sizeSm","1","sizeLg","1"],["class","icon-div-container","title","Editar",3,"click",4,"ngIf"],["sizeSm","2.5","sizeLg","2.5",3,"click"],[1,"pointerText"],["title","Reparado"],["name","car","style","color: blueviolet;pointer-events: none;",4,"ngIf"],["title","Sin Reparar"],["name","construct","style","color: red;pointer-events: none;",4,"ngIf"],["class","icon-div-container","title","Eliminar",3,"click",4,"ngIf"],["title","Editar",1,"icon-div-container",3,"click"],["name","pencil",2,"color","#22388c","pointer-events","none"],["name","car",2,"color","blueviolet","pointer-events","none"],["name","construct",2,"color","red","pointer-events","none"],["title","Eliminar",1,"icon-div-container",3,"click"],["name","trash","color","danger",2,"pointer-events","none"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header",0),e.TgZ(1,"ion-toolbar",1),e.TgZ(2,"ion-title"),e._uU(3,"Lista de Reparaciones"),e.qZA(),e.TgZ(4,"ion-buttons",2),e.TgZ(5,"div",3),e._UZ(6,"ion-icon",4),e.qZA(),e.TgZ(7,"div",5),e.NdJ("click",function(){return t.logout()}),e._UZ(8,"ion-icon",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"ion-toolbar",1),e.TgZ(10,"ion-row"),e.TgZ(11,"ion-col",7),e.TgZ(12,"ion-searchbar",8),e.NdJ("ionChange",function(r){return t.onSearchChange(r)}),e.qZA(),e.qZA(),e.TgZ(13,"ion-col",9),e.TgZ(14,"ion-item",10),e.TgZ(15,"ion-label"),e._uU(16,"Estado del veh\xedculo"),e.qZA(),e.TgZ(17,"ion-select",11),e.NdJ("ionChange",function(r){return t.setCarByStatus(r)}),e.TgZ(18,"ion-select-option",12),e._uU(19,"Reparado"),e.qZA(),e.TgZ(20,"ion-select-option",13),e._uU(21,"Sin reparar"),e.qZA(),e.TgZ(22,"ion-select-option",14),e._uU(23,"Todos"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"ion-row",15),e.TgZ(25,"ion-col",16),e._UZ(26,"ion-text"),e.qZA(),e.TgZ(27,"ion-col",17),e.TgZ(28,"ion-text"),e._uU(29,"Matr\xedcula"),e.qZA(),e.qZA(),e.TgZ(30,"ion-col",17),e.TgZ(31,"ion-text"),e._uU(32,"Fecha de Alta"),e.qZA(),e.qZA(),e.TgZ(33,"ion-col",17),e.TgZ(34,"ion-text"),e._uU(35,"Coste"),e.qZA(),e.qZA(),e.TgZ(36,"ion-col",17),e.TgZ(37,"ion-text"),e._uU(38,"Reparado"),e.qZA(),e.qZA(),e.TgZ(39,"ion-col",16),e._UZ(40,"ion-text"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(41,"ion-content",18),e.TgZ(42,"ion-refresher",19),e.NdJ("ionRefresh",function(r){return t.reset(r)}),e._UZ(43,"ion-refresher-content"),e.qZA(),e.TgZ(44,"div",20),e.TgZ(45,"ion-grid",21),e.YNc(46,S,19,7,"ion-row",22),e.qZA(),e.TgZ(47,"ion-infinite-scroll",23),e.NdJ("ionInfinite",function(r){return t.infiniteLoad(r)}),e._UZ(48,"ion-infinite-scroll-content",24),e.qZA(),e.qZA(),e.qZA()),2&i&&(e.Q6J("translucent",!1),e.xp6(41),e.Q6J("fullscreen",!0),e.xp6(5),e.Q6J("ngForOf",t.carRepairs))},directives:[a.Gu,a.sr,a.wd,a.Sm,a.YI,h.rH,a.gu,a.Nd,a.wI,a.VI,a.j9,a.Ie,a.Q$,a.t9,a.QI,a.n0,a.yW,a.W2,a.nJ,a.Wo,a.jY,p.sg,a.ju,a.MB,p.O5],styles:['@media screen and (min-width: 601px){ion-text[_ngcontent-%COMP%]{font-size:18px!important}ion-item[_ngcontent-%COMP%]{size:18px}}@media screen and (max-width: 600px){ion-text[_ngcontent-%COMP%]{font-size:11px!important}ion-item[_ngcontent-%COMP%]{size:11px}}@media screen and (max-width: 360px){ion-text[_ngcontent-%COMP%]{font-size:10px!important}ion-item[_ngcontent-%COMP%]{size:10px}}ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#4b4b4d!important}.header-row[_ngcontent-%COMP%]{margin-right:2%;border-radius:0%;border:0px}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{text-align:center}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#fff!important;font-size:1.2rem;text-align:center}.row[_ngcontent-%COMP%]{color:#fff;font-size:1.1rem;background-color:#fff!important;border:1px solid #b3b3b3;border-radius:25px;margin:.6% 1%;cursor:pointer}.body[_ngcontent-%COMP%]{background:#d0e5f0!important;font-family:"Roboto",sans-serif;color:#4b4b4d;min-height:100%}ion-icon[_ngcontent-%COMP%]{pointer-events:none;color:#fff}']}),o})()}];let L=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[h.Bz.forChild(A)],h.Bz]}),o})();var P=s(8816);let w=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[p.ez,u.u5,a.Pc,L,P.h,u.UX]]}),o})()}}]);