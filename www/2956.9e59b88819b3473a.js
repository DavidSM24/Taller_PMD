"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2956],{2956:(M,p,a)=>{a.r(p),a.d(p,{AgencyListPageModule:()=>E});var f=a(6019),y=a(9010),l=a(2651),m=a(8725),u=a(4762),Z=a(2483),e=a(865),C=a(9574),A=a(371),T=a(9311),v=a(7524);function x(o,g){if(1&o){const i=e.EpF();e.TgZ(0,"ion-row",22),e.TgZ(1,"ion-col",23),e.TgZ(2,"ion-text",24),e.NdJ("click",function(){const s=e.CHM(i).$implicit;return e.oxw().edit(s)}),e._UZ(3,"ion-icon",25),e.qZA(),e.qZA(),e.TgZ(4,"ion-col",26),e.TgZ(5,"ion-text"),e._uU(6),e.qZA(),e.qZA(),e.TgZ(7,"ion-col",26),e.TgZ(8,"ion-text"),e._uU(9),e.qZA(),e.qZA(),e.TgZ(10,"ion-col",26),e.TgZ(11,"ion-text"),e._uU(12),e.qZA(),e.qZA(),e.TgZ(13,"ion-col",26),e.TgZ(14,"ion-text"),e._uU(15),e.qZA(),e.qZA(),e.TgZ(16,"ion-col",23),e.TgZ(17,"ion-text",27),e.NdJ("click",function(){const s=e.CHM(i).$implicit;return e.oxw().showDeleteMenu(s)}),e._UZ(18,"ion-icon",28),e.qZA(),e.qZA(),e.qZA()}if(2&o){const i=g.$implicit;e.Q6J("ngClass",g.index%2==0?"normal":"colored"),e.xp6(6),e.hij(" ",i.zipCode," "),e.xp6(3),e.hij(" ",i.myInsuranceCompany.cia_Name," "),e.xp6(3),e.hij(" ",i.location," "),e.xp6(3),e.hij(" ",i.points," ")}}const b=[{path:"",component:(()=>{class o{constructor(i,t,n,s,h,r,c){this.as=i,this.AlertCtrl=t,this.modalCtrl=n,this.pt=s,this.uts=h,this.authS=r,this.us=c,this.agencies=[],this.oldAgencies=[],this.searchStr=""}ngOnInit(){}ionViewWillEnter(){return(0,u.mG)(this,void 0,void 0,function*(){this.niTems=Math.ceil(this.pt.height()/20+10),console.log(this.as.added),this.as.added?(this.reset(null),this.as.added=!1):yield this.loadAgencies()})}loadAgencies(i){return(0,u.mG)(this,void 0,void 0,function*(){let t=[];0==this.agencies.length&&(yield this.uts.presentLoading(),this.infinite.disabled=!1,this.oldInfinite=!1,t=yield this.as.getAllPaged(this.niTems,0),this.agencies=this.agencies.concat(t),this.agencies=this.sortList(this.agencies),this.oldAgencies=[],this.oldAgencies=this.oldAgencies.concat(t)),t.length<this.niTems&&(this.infinite.disabled=!0,this.oldInfinite=!0),i&&i.target.complete(),yield this.uts.hideLoading()})}edit(i){return(0,u.mG)(this,void 0,void 0,function*(){try{const t=yield this.modalCtrl.create({component:Z.L,cssClass:"fullscreen",componentProps:{agency:i}});yield t.present();const n=yield t.onDidDismiss();if(null!=n.data){let s=this.agencies.indexOf(i);this.agencies[s]=n.data.newAgency,this.oldAgencies.forEach(h=>{if(h.id==n.data.newAgency.id){let r=this.oldAgencies.indexOf(h);this.oldAgencies[r]=this.agencies[s]}})}}catch(t){console.log(t)}})}delete(i){return(0,u.mG)(this,void 0,void 0,function*(){if(i.myCarRepairs.length>0||i.myExchangesGifts.length>0){let t="Error. ";i.myCarRepairs.length>0&&i.myExchangesGifts.length>0?t+="No se puede eliminar la agencia porque tiene reparaciones y pedidos asociados.":i.myCarRepairs.length>0?t+="No se puede eliminar la agencia porque tiene reparaciones asociadas.":i.myExchangesGifts.length>0&&(t+="No se puede eliminar la agencia porque tiene pedidos asociados."),this.uts.presentToast(t,"danger","ban")}else{let t=i.myUser;yield this.uts.presentLoading();const n=yield this.as.delete(i);let s=this.agencies.indexOf(i,0);yield this.uts.hideLoading(),n?(s>-1&&(this.agencies.splice(s,1),this.oldAgencies.forEach(r=>{if(r.id==i.id){let c=this.oldAgencies.indexOf(r);this.oldAgencies.splice(c,1)}}),(yield this.us.delete(t))||this.uts.presentToast("Error al eliminar el usuario asociado.","danger","ban")),this.uts.presentToast("Agencia eliminada correctamente.","success","checkmark-circle-outline")):this.uts.presentToast("Error al eliminar la agencia...","danger","ban")}})}showDeleteMenu(i){return(0,u.mG)(this,void 0,void 0,function*(){yield(yield this.AlertCtrl.create({header:"Confirmaci\xf3n",message:"\xbfDesea eliminar esta Agencia? Tambi\xe9n se eliminar\xe1 el usuario asociado.",buttons:[{text:"Eliminar",cssClass:"rojo",handler:()=>{this.delete(i)}},{text:"Cancelar",cssClass:"secondary",role:"cancel"}]})).present()})}infiniteLoad(i){return(0,u.mG)(this,void 0,void 0,function*(){let t=[];this.infinite.disabled||(t=yield this.as.getAllPaged(this.niTems,this.agencies.length),this.agencies=this.agencies.concat(t),this.oldAgencies=this.oldAgencies.concat(t),t.length<30&&(this.infinite.disabled=!0,this.oldInfinite=!0)),this.infinite.complete()})}onSearchChange(i){this.searchStr=i.detail.value}reset(i){return(0,u.mG)(this,void 0,void 0,function*(){this.infinite.disabled=!1,this.oldInfinite=!1,this.agencies=[],this.loadAgencies(i)})}logout(){this.authS.logout()}searchChange(i){return(0,u.mG)(this,void 0,void 0,function*(){this.searchStr=i.detail.value;let t=new RegExp("^[ ]");try{if(this.searchStr.match(t))this.uts.presentToast("La b\xfasqueda no puede comenzar por espacios en blanco.","danger","ban");else{let n=[],s=[];this.agencies=[];let h=this.searchStr.length;h>0?(yield this.uts.presentLoading(),s=yield this.as.getByUserNamePaged(this.searchStr,99999,0),s.forEach(r=>{let c=!0;n.forEach(d=>{d.id==r.id&&(c=!1)}),c&&n.push(r)}),s=yield this.as.getByAddress(this.searchStr),s.forEach(r=>{let c=!0;n.forEach(d=>{d.id==r.id&&(c=!1)}),c&&n.push(r)}),s=yield this.as.getByCompany(this.searchStr),s.forEach(r=>{let c=!0;n.forEach(d=>{d.id==r.id&&(c=!1)}),c&&n.push(r)}),s=yield this.as.getByLocation(this.searchStr),s.forEach(r=>{let c=!0;n.forEach(d=>{d.id==r.id&&(c=!1)}),c&&n.push(r)}),+this.searchStr>=0&&(s=yield this.as.getByPoints(+this.searchStr),s.forEach(r=>{let c=!0;n.forEach(d=>{d.id==r.id&&(c=!1)}),c&&n.push(r)})),+this.searchStr>=0&&(s=yield this.as.getByZipcode(+this.searchStr),s.forEach(r=>{let c=!0;n.forEach(d=>{d.id==r.id&&(c=!1)}),c&&n.push(r)})),this.agencies=n,this.agencies=this.sortList(this.agencies),this.infinite.disabled=!0,yield this.uts.hideLoading()):h<1&&(this.agencies=[],this.agencies=this.agencies.concat(this.oldAgencies),this.agencies=this.sortList(this.agencies),this.infinite.disabled=this.oldInfinite,yield this.uts.hideLoading())}}catch(n){}})}sortList(i){return null!=i&&i.length>1&&(i=i.sort((t,n)=>t.myInsuranceCompany.cia_Name>n.myInsuranceCompany.cia_Name?1:t.myInsuranceCompany.cia_Name<n.myInsuranceCompany.cia_Name?-1:t.id>n.id?1:t.id<n.id?-1:0)),i}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(C.Y),e.Y36(l.Br),e.Y36(l.IN),e.Y36(l.t4),e.Y36(A.f),e.Y36(T.e),e.Y36(v.K))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-agency-list"]],viewQuery:function(i,t){if(1&i&&e.Gf(l.ju,5),2&i){let n;e.iGM(n=e.CRH())&&(t.infinite=n.first)}},decls:40,vars:3,consts:[[3,"translucent"],["color","primary"],["slot","end",1,"icon-div-container",2,"margin-right","1%"],["title","Nuevo","routerLink","/tab-administrator/user/create"],["slot","end",1,"icon-logout",2,"pointer-events","none","zoom","1.5","cursor","pointer","content","url(../../../../assets/icon/add-circle-outline.png)"],["title","Lista de Usuarios","routerLink","/tab-administrator/user/list"],["slot","end",1,"icon-logout",2,"pointer-events","none","zoom","1.3","cursor","pointer","content","url( ../../../../assets/icon/user_list.png)"],["title","Lista de Compa\xf1\xedas de Seguros","routerLink","/tab-administrator/company/list"],["slot","end",1,"icon-logout",2,"pointer-events","none","zoom","1.3","cursor","pointer","content","url( ../../../../assets/icon/company_list.png)"],["title","Cerrar Sesi\xf3n",3,"click"],["slot","end","name","log-out-outline",1,"icon-logout",2,"pointer-events","none","zoom","1.7","cursor","pointer"],["placeholder","Encuentra la agencia que est\xe1s buscando...","debounce","1000","inputmode","text","type","text","showCancelButton","always",3,"ionChange"],[1,"header-row"],["size","1",2,"border","0px !important"],["size","2.5",2,"border","0px !important"],[2,"background-color","white",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"body"],[1,"ion-text-center"],["style","border-left: 1px solid #4b4b4d;border-right: 1px solid #4b4b4d;","let","",3,"ngClass",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText",""],["let","",2,"border-left","1px solid #4b4b4d","border-right","1px solid #4b4b4d",3,"ngClass"],["size","1"],["title","Editar",1,"icon-div-container",3,"click"],["name","pencil",2,"color","#22388c","pointer-events","none"],["size","2.5"],["title","Eliminar",1,"icon-div-container",3,"click"],["name","trash","color","danger",2,"pointer-events","none"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header",0),e.TgZ(1,"ion-toolbar",1),e.TgZ(2,"ion-title"),e._uU(3,"Lista de Agencias"),e.qZA(),e.TgZ(4,"ion-buttons",2),e.TgZ(5,"div",3),e._UZ(6,"ion-icon",4),e.qZA(),e.TgZ(7,"div",5),e._UZ(8,"ion-icon",6),e.qZA(),e.TgZ(9,"div",7),e._UZ(10,"ion-icon",8),e.qZA(),e.TgZ(11,"div",9),e.NdJ("click",function(){return t.logout()}),e._UZ(12,"ion-icon",10),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"ion-toolbar",1),e.TgZ(14,"ion-searchbar",11),e.NdJ("ionChange",function(s){return t.searchChange(s)}),e.qZA(),e.TgZ(15,"ion-row",12),e.TgZ(16,"ion-col",13),e._UZ(17,"ion-text"),e.qZA(),e.TgZ(18,"ion-col",14),e.TgZ(19,"ion-text"),e._uU(20,"C\xf3digo Zip"),e.qZA(),e.qZA(),e.TgZ(21,"ion-col",14),e.TgZ(22,"ion-text"),e._uU(23,"Compa\xf1\xeda"),e.qZA(),e.qZA(),e.TgZ(24,"ion-col",14),e.TgZ(25,"ion-text"),e._uU(26,"Localidad"),e.qZA(),e.qZA(),e.TgZ(27,"ion-col",14),e.TgZ(28,"ion-text"),e._uU(29,"Puntos"),e.qZA(),e.qZA(),e.TgZ(30,"ion-col",13),e._UZ(31,"ion-text"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"ion-content",15),e.TgZ(33,"ion-refresher",16),e.NdJ("ionRefresh",function(s){return t.reset(s)}),e._UZ(34,"ion-refresher-content"),e.qZA(),e.TgZ(35,"div",17),e.TgZ(36,"ion-grid",18),e.YNc(37,x,19,5,"ion-row",19),e.qZA(),e.TgZ(38,"ion-infinite-scroll",20),e.NdJ("ionInfinite",function(s){return t.infiniteLoad(s)}),e._UZ(39,"ion-infinite-scroll-content",21),e.qZA(),e.qZA(),e.qZA()),2&i&&(e.Q6J("translucent",!1),e.xp6(32),e.Q6J("fullscreen",!0),e.xp6(5),e.Q6J("ngForOf",t.agencies))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YI,m.rH,l.gu,l.VI,l.j9,l.Nd,l.wI,l.yW,l.W2,l.nJ,l.Wo,l.jY,f.sg,l.ju,l.MB,f.mk],styles:['ion-col[_ngcontent-%COMP%]{border-bottom:1px solid #4b4b4d}ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#4b4b4d!important}.header-row[_ngcontent-%COMP%]{border-radius:0%;border:0px}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{text-align:center}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#fff!important;text-align:center}.body[_ngcontent-%COMP%]{background-color:#fff;font-family:"Roboto",sans-serif;color:#4b4b4d}.normal[_ngcontent-%COMP%]{background-color:#fff;font-size:1.1rem}.colored[_ngcontent-%COMP%]{background-color:#cdcccc;font-size:1.1rem}']}),o})(),children:[{path:"agency-saw",loadChildren:()=>a.e(9969).then(a.bind(a,9969)).then(o=>o.AgencySawPageModule)},{path:"agency-update",loadChildren:()=>a.e(8592).then(a.bind(a,9226)).then(o=>o.AgencyUpdatePageModule)},{path:"agency-create",loadChildren:()=>a.e(1939).then(a.bind(a,1939)).then(o=>o.AgencyCreatePageModule)}]}];let L=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[m.Bz.forChild(b)],m.Bz]}),o})();var P=a(8816);let E=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[A.f],imports:[[f.ez,l.Pc,L,y.u5,y.UX,P.h]]}),o})()}}]);