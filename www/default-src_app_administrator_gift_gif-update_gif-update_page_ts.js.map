{"version":3,"file":"default-src_app_administrator_gift_gif-update_gif-update_page_ts.js","mappings":"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","sources":["./src/app/administrator/gift/gif-update/gif-update.page.ts","./src/app/administrator/gift/gif-update/gif-update.page.html"],"sourcesContent":["import { Component, Input, OnInit, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { IonToggle, ModalController } from '@ionic/angular';\r\nimport { Gift } from 'src/app/models/Gift';\r\nimport { GiftService } from 'src/app/services/gift.service';\r\nimport { UtilService } from 'src/app/services/util.service';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\n@Component({\r\n  selector: 'app-gif-update',\r\n  templateUrl: './gif-update.page.html',\r\n  styleUrls: ['./gif-update.page.scss'],\r\n})\r\nexport class GifUpdatePage implements OnInit {\r\n\r\n  @ViewChild(IonToggle) toggle: IonToggle;\r\n  @Input() gift: Gift;\r\n\r\n  public formGift: FormGroup;\r\n  public edited: boolean;\r\n  public img: string;\r\n  public formTest: FormGroup;\r\n  public file: any = null;\r\n  private extension: string;\r\n  public errorMsg:boolean;\r\n\r\n  constructor(\r\n    private modalCtrl: ModalController,\r\n    private gs: GiftService,\r\n    private fb: FormBuilder,\r\n    private uts: UtilService,\r\n    private http: HttpClient) {\r\n\r\n    this.formGift = this.fb.group({\r\n      name: [\"\", Validators.required],\r\n      points: [\"\", Validators.required],\r\n    });\r\n  }\r\n\r\n  async ngOnInit() {\r\n\r\n    try {\r\n\r\n      this.file = await this.http.get(\"https://res.cloudinary.com/duq0pz1vi/image/upload/v1645471738/\" + this.gift.picture, { responseType: 'blob' }).subscribe((resp: any) => {\r\n        this.file = resp;\r\n\r\n      });\r\n\r\n      this.formGift = this.fb.group({\r\n        name: [this.gift.name, [Validators.required, Validators.minLength(3),Validators.maxLength(50)]],\r\n        points: [this.gift.points, [Validators.required,Validators.min(1),Validators.pattern(\"[0-9]+\")]]\r\n      });\r\n    } catch (error) {\r\n\r\n    }\r\n\r\n\r\n  }\r\n  async ionViewWillEnter() {\r\n    this.img = \"https://res.cloudinary.com/duq0pz1vi/image/upload/v1645471738/\"+this.gift.picture;\r\n  }\r\n\r\n  public async edit(): Promise<void> {\r\n\r\n    if(this.formGift.get('points').value>0){\r\n      await this.uts.presentLoading();\r\n\r\n      let newGift: Gift = {\r\n        id:this.gift.id,\r\n        name: this.formGift.get(\"name\").value,\r\n        points: this.formGift.get(\"points\").value,\r\n        available: this.toggle.checked,\r\n        picture: '',\r\n        exchangeGifts: this.gift.exchangeGifts\r\n      }\r\n\r\n      newGift = await this.gs.createOrUpdate(newGift, this.file);\r\n      if (newGift.id) {\r\n        this.formGift.reset();\r\n        this.uts.presentToast('El regalo se ha modificado correctamente.', 'success',\"checkmark-circle-outline\");\r\n      }\r\n      else {\r\n        this.uts.presentToast('Ha habido un error relacionado con subida de la imagen. Inténtelo más tarde.', 'danger','ban');\r\n        newGift=null;\r\n      }\r\n\r\n      await this.uts.hideLoading();\r\n\r\n      if(newGift){\r\n        this.modalCtrl.dismiss({\r\n          newGift:newGift\r\n        })\r\n      }\r\n      else this.modalCtrl.dismiss();\r\n\r\n    }\r\n    else this.uts.presentToast('Los puntos deben ser superiores a 0.', 'danger','ban');\r\n\r\n\r\n\r\n  }\r\n\r\n  close() {\r\n    this.modalCtrl.dismiss();\r\n  }\r\n\r\n  public changeListener($event): void {\r\n    try {\r\n      if ($event) {\r\n\r\n        let extension: string = $event.target.files[0].type.toString();\r\n        if (extension == (\"image/jpeg\")\r\n          || extension == (\"image/png\")) {\r\n          this.file = $event.target.files[0];\r\n          this.extension = this.file.type;\r\n          this.img=URL.createObjectURL(this.file);\r\n          this.errorMsg=false;\r\n        }\r\n        else {\r\n          this.file = null;\r\n          this.errorMsg=true;\r\n        }\r\n      }\r\n    } catch (error) {\r\n      //alert\r\n      this.file = null;\r\n      this.errorMsg=true;\r\n    }\r\n\r\n    \r\n  }\r\n\r\n}\r\n","export default \"<ion-header [translucent]=\\\"true\\\">\\r\\n  <ion-toolbar color=\\\"primary\\\">\\r\\n    <ion-title>\\r\\n      Editar Regalo\\r\\n    </ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content [fullscreen]=\\\"true\\\">\\r\\n\\r\\n  <div class=\\\"body\\\">\\r\\n    <div class=\\\"ion-padding\\\">\\r\\n      <div class=\\\"center\\\">\\r\\n\\r\\n        <ion-card>\\r\\n          <ion-img  [src]=\\\"this.img\\\"></ion-img>\\r\\n        </ion-card>\\r\\n\\r\\n      </div>\\r\\n    </div>\\r\\n    <form [formGroup]=\\\"formGift\\\" class=\\\"ion-padding\\\">\\r\\n      <div class=\\\"formulario\\\">\\r\\n      <ion-grid>\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col sizeSm=\\\"1\\\" sizeLg=\\\"1\\\">\\r\\n            <ion-label>Nombre:</ion-label>\\r\\n          </ion-col>\\r\\n          <ion-col sizeSm=\\\"11\\\" sizeLg=\\\"11\\\">\\r\\n            <ion-input type=\\\"text\\\" class=\\\"customInput\\\" formControlName=\\\"name\\\"></ion-input>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col>\\r\\n            <p style=\\\"color:red;\\\" *ngIf=\\\"this.formGift.get('name').invalid&&formGift.get('name').touched\\\">\\r\\n              *Campo obligatorio. Debe introducir entre 3 y 50 caracteres.\\r\\n            </p>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col sizeSm=\\\"1\\\" sizeLg=\\\"1\\\">\\r\\n            <ion-label>Puntos:</ion-label>\\r\\n          </ion-col>\\r\\n          <ion-col sizeSm=\\\"11\\\" sizeLg=\\\"11\\\">\\r\\n            <ion-input class=\\\"customInput\\\" type=\\\"number\\\" formControlName=\\\"points\\\"></ion-input>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col>\\r\\n            <p style=\\\"color:red;\\\" *ngIf=\\\"this.formGift.get('points').invalid&&formGift.get('points').touched\\\">\\r\\n              *Campo obligatorio. El valor mínimo es 1 punto.\\r\\n            </p>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col sizeSm=\\\"9\\\" sizeLg=\\\"1.5\\\">\\r\\n            Disponible:\\r\\n          </ion-col>\\r\\n          <ion-col sizeSm=\\\"3\\\" sizeLg=\\\"9.5  \\\">\\r\\n            <ion-item  lines=\\\"none\\\">\\r\\n              No<ion-toggle [checked]=\\\"this.gift.available\\\"></ion-toggle>Si\\r\\n           </ion-item>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n\\r\\n          <ion-col size=\\\"12\\\">\\r\\n            <ion-input type=\\\"file\\\" accept=\\\".jpg,.jpeg,.png\\\" (change)=\\\"changeListener($event)\\\"></ion-input>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col>\\r\\n            <p style=\\\"color:red;\\\" *ngIf=\\\"this.errorMsg\\\">\\r\\n              *Campo obligatorio. Debe seleccionar un archivo válido para imagen (png, jpg, etc.).\\r\\n            </p>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n\\r\\n          <ion-col size=\\\"6\\\">\\r\\n            <ion-button expand=\\\"block\\\" shape=\\\"round\\\" style=\\\"margin-top: 2% !important;\\\" (click)=\\\"close()\\\" class=\\\"button\\\">\\r\\n              Cancelar\\r\\n            </ion-button>\\r\\n          </ion-col>\\r\\n\\r\\n          <ion-col size=\\\"6\\\">\\r\\n            <ion-button expand=\\\"block\\\" shape=\\\"round\\\" style=\\\"margin-top: 2% !important;\\\" (click)=\\\"edit()\\\" class=\\\"button\\\" [disabled]=\\\"this.formGift.invalid||this.file==null\\\">\\r\\n              ACTUALIZAR\\r\\n            </ion-button>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n      </ion-grid>\\r\\n    </div>\\r\\n    </form>\\r\\n\\r\\n</div>\\r\\n</ion-content>\\r\\n\\r\\n\";"],"names":[],"sourceRoot":"webpack:///"}