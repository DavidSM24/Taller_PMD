"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2440],{2440:(q,m,l)=>{l.r(m),l.d(m,{ExchangeGiftListPageModule:()=>b});var x=l(6019),Z=l(9010),r=l(2651),u=l(8725),d=l(4762),p=l(8667),G=l(1549),e=l(865),v=l(922),E=l(9311);function T(o,f){1&o&&(e.TgZ(0,"div",40),e._UZ(1,"ion-icon",41),e.qZA())}function y(o,f){1&o&&(e.TgZ(0,"div",42),e._UZ(1,"ion-icon",43),e.qZA())}function A(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"ion-row",26),e.TgZ(1,"ion-col",27),e.TgZ(2,"ion-text"),e.TgZ(3,"div",28),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().edit(s)}),e._UZ(4,"ion-icon",29),e.qZA(),e.qZA(),e.qZA(),e.TgZ(5,"ion-col",27),e.TgZ(6,"ion-text"),e.TgZ(7,"div",30),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().saw(s)}),e._UZ(8,"ion-icon",31),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"ion-col",27),e.TgZ(10,"ion-text"),e.TgZ(11,"div",32),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().changeDeliveredAlert(s)}),e.TgZ(12,"ion-icon",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().changeDeliveredAlert(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"ion-col",34),e.TgZ(14,"ion-text"),e._uU(15),e.qZA(),e.qZA(),e.TgZ(16,"ion-col",34),e.TgZ(17,"ion-text"),e._uU(18),e.qZA(),e.qZA(),e.TgZ(19,"ion-col",34),e.TgZ(20,"ion-text"),e._uU(21),e.qZA(),e.qZA(),e.TgZ(22,"ion-col",34),e.YNc(23,T,2,0,"div",35),e.YNc(24,y,2,0,"div",36),e.qZA(),e.TgZ(25,"ion-col",37),e.TgZ(26,"ion-text"),e.TgZ(27,"div",38),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().mensagealerta(s)}),e._UZ(28,"ion-icon",39),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=f.$implicit;e.xp6(15),e.hij(" ",t.dateExchange," "),e.xp6(3),e.hij(" ",t.agency.myInsuranceCompany.cia_Name+" - "+t.agency.location," "),e.xp6(3),e.hij(" ",t.gift.name," "),e.xp6(2),e.Q6J("ngIf",t.delivered),e.xp6(1),e.Q6J("ngIf",!t.delivered)}}const C=[{path:"",component:(()=>{class o{constructor(t,i,n,s,c,a,h){this.exs=t,this.loading=i,this.toast=n,this.alerta=s,this.pt=c,this.modalCtrl=a,this.authS=h,this.exGifts=[],this.oldExGifts=[],this.exGiftsx=[]}ionViewDidEnter(){return(0,d.mG)(this,void 0,void 0,function*(){this.niTems=Math.ceil(this.pt.height()/20+10),yield this.cargaExGifts()})}edit(t){return(0,d.mG)(this,void 0,void 0,function*(){try{const i=yield this.modalCtrl.create({component:p.s,cssClass:"fullscreen",componentProps:{exchange:t}});yield i.present();const n=yield i.onDidDismiss();if(null!=n.data){let s=this.exGifts.indexOf(t);this.exGifts[s]=n.data.newExchange,this.oldExGifts.forEach(c=>{if(c.id==n.data.newExchange.id){let a=this.oldExGifts.indexOf(c);this.oldExGifts[a]=this.exGifts[s]}})}}catch(i){console.log(i)}})}setbyExGiftByStatus(t){return(0,d.mG)(this,void 0,void 0,function*(){this.searchChange()})}saw(t){return(0,d.mG)(this,void 0,void 0,function*(){try{const i=yield this.modalCtrl.create({component:G.i,componentProps:{exchangesaw:t}});yield i.present();const n=yield i.onDidDismiss();if(null!=n.data){let s=this.exGifts.indexOf(t);this.exGifts[s]=n.data.newExchange;let c=this.oldExGifts.indexOf(t);this.oldExGifts[c]=n.data.newExchange}}catch(i){console.log(i)}})}cargaExGifts(t){return(0,d.mG)(this,void 0,void 0,function*(){this.infinite&&(this.infinite.disabled=!1,this.oldInfinite=!1),t||(yield this.presentLoading()),this.exGifts=[],this.oldExGifts=[];try{this.exGifts=yield this.exs.getAllPaged(this.niTems,this.exGifts.length),this.exGifts=this.sortList(this.exGifts),this.oldExGifts=this.oldExGifts.concat(this.exGifts),this.exGiftsx=this.exGifts}catch(i){console.error(i),yield this.presentToast("Error cargando datos","danger","ban")}finally{t?t.target.complete():yield this.miLoading.dismiss()}})}borra(t){return(0,d.mG)(this,void 0,void 0,function*(){if(yield this.presentLoading(),yield this.exs.delete(t)){let n=this.exGifts.indexOf(t,0);n>-1&&this.exGifts.splice(n,1),this.oldExGifts.forEach(s=>{if(s.id==t.id){let c=this.oldExGifts.indexOf(s);this.oldExGifts.splice(c,1)}}),this.presentToast("Pedido eliminado correctamente.","success","checkmark-circle-outline")}else this.presentToast("Ha habido un error al intentar eliminar el pedido.","danger","ban");yield this.miLoading.dismiss()})}presentLoading(){return(0,d.mG)(this,void 0,void 0,function*(){this.miLoading=yield this.loading.create({message:""}),yield this.miLoading.present()})}presentToast(t,i,n){return(0,d.mG)(this,void 0,void 0,function*(){(yield this.toast.create({message:t,duration:2e3,color:i,icon:n})).present()})}mensagealerta(t){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alerta.create({header:"Eliminar",message:"\xbfDesea eliminar este Pedido?",buttons:[{text:"Eliminar",cssClass:"rojo",handler:()=>{this.borra(t)}},{text:"Cancelar",cssClass:"secondary",handler:n=>{}}]})).present()})}infiniteLoad(t){return(0,d.mG)(this,void 0,void 0,function*(){let i=[];this.infinite.disabled||(i=yield this.exs.getAllPaged(this.niTems,this.exGifts.length),i=this.sortList(i),this.exGifts=this.exGifts.concat(i),this.oldExGifts=this.oldExGifts.concat(i),i.length<30&&(this.infinite.disabled=!0,this.oldInfinite=!0))})}reset(t){return(0,d.mG)(this,void 0,void 0,function*(){this.infinite.disabled=!1,this.oldInfinite=!1,this.exGifts=[],this.oldExGifts=[],this.cargaExGifts(t)})}logout(){this.authS.logout()}onSearchChange(t){this.searchStr=t.detail.value}searchChange(){return(0,d.mG)(this,void 0,void 0,function*(){let t=[],i=[],n=this.select.value;this.searchStr=this.sb.value;let s=[];this.exGifts=[];let c=this.searchStr.length;c>0?(yield this.presentLoading(),s=yield this.exs.getByDateFilter(this.searchStr),s.forEach(a=>{let h=!0;t.forEach(g=>{g.id==a.id&&(h=!1)}),h&&t.push(a)}),+this.searchStr>=0&&(s=yield this.exs.getByPoints(this.searchStr),s.forEach(a=>{let h=!0;t.forEach(g=>{g.id==a.id&&(h=!1)}),h&&t.push(a)})),s=yield this.exs.getByGiftName(this.searchStr),s.forEach(a=>{let h=!0;t.forEach(g=>{g.id==a.id&&(h=!1)}),h&&t.push(a)}),s=yield this.exs.getByAgencyUsername(this.searchStr),s.forEach(a=>{let h=!0;t.forEach(g=>{g.id==a.id&&(h=!1)}),h&&t.push(a)}),"true"==n?(t.forEach(a=>{a.delivered&&i.push(a)}),this.exGifts=i,this.exGifts=this.sortList(this.exGifts)):"false"==n?(t.forEach(a=>{a.delivered||i.push(a)}),this.exGifts=i,this.exGifts=this.sortList(this.exGifts)):(this.exGifts=t,this.exGifts=this.sortList(this.exGifts)),this.infinite.disabled=!1,yield this.miLoading.dismiss()):c<1&&(t=t.concat(this.oldExGifts),this.infinite.disabled=this.oldInfinite,"true"==n?(t.forEach(a=>{a.delivered&&i.push(a)}),this.exGifts=i,this.exGifts=this.sortList(this.exGifts)):"false"==n?(t.forEach(a=>{a.delivered||i.push(a)}),this.exGifts=i,this.exGifts=this.sortList(this.exGifts)):(this.exGifts=t,this.exGifts=this.sortList(this.exGifts)),this.infinite.disabled=this.oldInfinite,yield this.miLoading.dismiss())})}changeDeliveredAlert(t){return(0,d.mG)(this,void 0,void 0,function*(){let i;i=t.delivered?"Pendiente":"Entregado",yield(yield this.alerta.create({header:"Cambio de estado de pedido.",message:"El estado de este pedido se cambiar\xe1 a "+i+", \xbfest\xe1 seguro que quiere continuar?",buttons:[{text:"Aceptar",cssClass:"secondary",handler:()=>{this.changeDelivered(t)}},{text:"Cancelar",cssClass:"rojo",handler:s=>{}}]})).present()})}changeDelivered(t){return(0,d.mG)(this,void 0,void 0,function*(){if(null!=t){let i;t.delivered=!t.delivered,i=t.delivered?"Entregado":"Pendiente";try{yield this.presentLoading(),null!=(t=yield this.exs.createOrUpdate(t))&&this.presentToast("Se ha cambiado el estado del pedido a "+i+".","success","checkmark-circle-outline"),yield this.miLoading.dismiss()}catch(n){console.log(n),this.presentToast("Ha habido un error al cambiar el estado del pedido.","danger","ban"),yield this.miLoading.dismiss()}}})}sortList(t){return null!=t&&t.length>1&&(t=t.sort((i,n)=>i.dateExchange>n.dateExchange?1:i.dateExchange<n.dateExchange?-1:i.id>n.id?1:i.id<n.id?-1:0)),t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.y),e.Y36(r.HT),e.Y36(r.yF),e.Y36(r.Br),e.Y36(r.t4),e.Y36(r.IN),e.Y36(E.e))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-exchange-gift-list"]],viewQuery:function(t,i){if(1&t&&(e.Gf(r.ju,5),e.Gf(r.t9,5),e.Gf(r.VI,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.infinite=n.first),e.iGM(n=e.CRH())&&(i.select=n.first),e.iGM(n=e.CRH())&&(i.sb=n.first)}},decls:49,vars:3,consts:[[3,"translucent"],["color","primary"],["slot","end",1,"icon-div-container",2,"margin-right","1%"],["title","Nuevo","routerLink","/tab-administrator/exchange-gift/create"],["slot","end",1,"icon-logout",2,"pointer-events","none","zoom","1.5","cursor","pointer","content","url(../../../../assets/icon/add-circle-outline.png)"],["title","Cerrar Sesi\xf3n",3,"click"],["slot","end","name","log-out-outline",1,"icon-logout",2,"pointer-events","none","zoom","1.7","cursor","pointer"],["sizeSm","9.5","sizeLg","9.5"],["placeholder","Encuentra el canjeo que est\xe1s buscando...","inputmode","text","type","text","debounce","1000","showCancelButton","always",3,"ionChange"],["sizeSm","2.5","sizeLg","2.5",1,"selector"],[2,"height","85%","margin-top","1.1%"],["interface","popover","multiple","false",3,"ionChange"],["value","true"],["value","false"],["value","all"],[1,"header-row"],["size","1.4",2,"border","0px !important"],["size","2.5",2,"border","0px !important"],["size","1",2,"border","0px !important"],[2,"background-color","white",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"body"],[1,"ion-text-center"],["let","","class","row",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText",""],["let","",1,"row"],["size","0.5"],["title","Editar",2,"cursor","pointer",3,"click"],["name","pencil",1,"icon-c",2,"color","#22388c","cursor","pointer"],["title","Ver detalles",2,"cursor","pointer",3,"click"],["name","eye-outline",2,"color","#22388c","pointer-events","none"],["title","Cambiar estado",2,"cursor","pointer",3,"click"],["name","gift-outline",2,"color","#22388c","pointer-events","none",3,"click"],["size","2.5"],["title","Entregado",4,"ngIf"],["title","Pendiente",4,"ngIf"],["size","0.4"],["title","Eliminar",2,"cursor","pointer",3,"click"],["name","trash","color","danger",2,"pointer-events","none"],["title","Entregado"],["name","checkmark-circle",2,"color","#39ff14","pointer-events","none"],["title","Pendiente"],["name","close-circle",2,"color","red","pointer-events","none"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header",0),e.TgZ(1,"ion-toolbar",1),e.TgZ(2,"ion-title"),e._uU(3,"Lista de Pedidos"),e.qZA(),e.TgZ(4,"ion-buttons",2),e.TgZ(5,"div",3),e._UZ(6,"ion-icon",4),e.qZA(),e.TgZ(7,"div",5),e.NdJ("click",function(){return i.logout()}),e._UZ(8,"ion-icon",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"ion-toolbar",1),e.TgZ(10,"ion-row"),e.TgZ(11,"ion-col",7),e.TgZ(12,"ion-searchbar",8),e.NdJ("ionChange",function(){return i.searchChange()}),e.qZA(),e.qZA(),e.TgZ(13,"ion-col",9),e.TgZ(14,"ion-item",10),e.TgZ(15,"ion-label"),e._uU(16,"Entregado:"),e.qZA(),e.TgZ(17,"ion-select",11),e.NdJ("ionChange",function(){return i.searchChange()}),e.TgZ(18,"ion-select-option",12),e._uU(19,"Si"),e.qZA(),e.TgZ(20,"ion-select-option",13),e._uU(21,"No"),e.qZA(),e.TgZ(22,"ion-select-option",14),e._uU(23,"Todos"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"ion-row",15),e.TgZ(25,"ion-col",16),e._UZ(26,"ion-text"),e.qZA(),e.TgZ(27,"ion-col",17),e.TgZ(28,"ion-text"),e._uU(29,"Fecha de Intercambio"),e.qZA(),e.qZA(),e.TgZ(30,"ion-col",17),e.TgZ(31,"ion-text"),e._uU(32,"Nombre de Agencia"),e.qZA(),e.qZA(),e.TgZ(33,"ion-col",17),e.TgZ(34,"ion-text"),e._uU(35,"Nombre de Regalo"),e.qZA(),e.qZA(),e.TgZ(36,"ion-col",17),e.TgZ(37,"ion-text"),e._uU(38,"Entregado"),e.qZA(),e.qZA(),e.TgZ(39,"ion-col",18),e._UZ(40,"ion-text"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(41,"ion-content",19),e.TgZ(42,"ion-refresher",20),e.NdJ("ionRefresh",function(s){return i.reset(s)}),e._UZ(43,"ion-refresher-content"),e.qZA(),e.TgZ(44,"div",21),e.TgZ(45,"ion-grid",22),e.YNc(46,A,29,5,"ion-row",23),e.qZA(),e.TgZ(47,"ion-infinite-scroll",24),e.NdJ("ionInfinite",function(s){return i.infiniteLoad(s)}),e._UZ(48,"ion-infinite-scroll-content",25),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.Q6J("translucent",!1),e.xp6(41),e.Q6J("fullscreen",!0),e.xp6(5),e.Q6J("ngForOf",i.exGifts))},directives:[r.Gu,r.sr,r.wd,r.Sm,r.YI,u.rH,r.gu,r.Nd,r.wI,r.VI,r.j9,r.Ie,r.Q$,r.t9,r.QI,r.n0,r.yW,r.W2,r.nJ,r.Wo,r.jY,x.sg,r.ju,r.MB,x.O5],styles:['ion-col[_ngcontent-%COMP%]{border-bottom:1px solid #4b4b4d}ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#4b4b4d!important}.header-row[_ngcontent-%COMP%]{border-radius:0%;border:0px}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{text-align:center}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#fff!important;font-size:1.2rem;text-align:center}.row[_ngcontent-%COMP%]{color:#fff;font-size:1.1rem}.body[_ngcontent-%COMP%]{background-color:#fff;font-family:"Roboto",sans-serif;color:#4b4b4d}.icon-c[_ngcontent-%COMP%]{pointer-events:none}']}),o})(),children:[{path:"exchange-gif-update",loadChildren:()=>l.e(8592).then(l.bind(l,9252)).then(o=>o.ExchangeGifUpdatePageModule)},{path:"exchange-gif-saw",loadChildren:()=>l.e(8592).then(l.bind(l,6166)).then(o=>o.ExchangeGifSawPageModule)},{path:"exchange-gif-create",loadChildren:()=>l.e(8592).then(l.bind(l,2610)).then(o=>o.ExchangeGifCreatePageModule)}]}];let L=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[u.Bz.forChild(C)],u.Bz]}),o})();var P=l(8816),_=l(371);let b=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[_.f],imports:[[x.ez,Z.u5,r.Pc,L,Z.UX,P.h]]}),o})()}}]);