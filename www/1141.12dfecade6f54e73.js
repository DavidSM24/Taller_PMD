"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1141,922],{922:(T,Z,l)=>{l.d(Z,{y:()=>L});var m=l(4762),b=l(8260),v=l(865),n=l(4522);let L=(()=>{class g{constructor(t){this.http=t,this.endpoint="/exchangeGifts",this.URLDatabase=b.N.herokuConfig.url}getListData(t){return(0,m.mG)(this,void 0,void 0,function*(){let r=[];return new Promise(d=>{this.http.get(t).subscribe(s=>{if(null!=s&&s.length>0)for(let f of s)r.push({id:f.id,dateExchange:f.dateExchange,observations:f.observations,delivered:f.delivered,agency:f.agency,gift:f.gift});console.log(s),d(r)},s=>{console.log(s)})})})}getAllPaged(t,r){return this.getListData(this.URLDatabase+this.endpoint+"/element/"+t+"/page/"+r)}getAll(){return this.getListData(this.URLDatabase+this.endpoint)}getByDateFilter(t){return this.getListData(this.URLDatabase+this.endpoint+"/date/"+t)}getByPoints(t){return this.getListData(this.URLDatabase+this.endpoint+"/points/"+t)}getByAgencyUsername(t){return this.getListData(this.URLDatabase+this.endpoint+"/auname/"+t)}getById(t){return(0,m.mG)(this,void 0,void 0,function*(){let r=null;return new Promise(d=>{this.http.get(this.URLDatabase+this.endpoint+"/id/"+t).subscribe(s=>{s.id&&(r={id:s.id,dateExchange:s.dateExchange,observations:s.observations,delivered:s.delivered,agency:s.agency,gift:s.gift}),console.log(r),d(r)},s=>{console.log(s),console.log(r),d(r)})})})}getByDeliveredPaged(t,r,d){return this.getListData(this.URLDatabase+this.endpoint+"/delivered/"+t+"/element/"+r+"/paged/"+d)}getByGiftName(t){return this.getListData(this.URLDatabase+this.endpoint+"/gname/"+t)}getByAgencyPaged(t,r,d){if(null!=t)return this.getListData(this.URLDatabase+this.endpoint+"/id_agency/"+t.id+"/element/"+r+"/paged/"+d);{let s;return s}}createOrUpdate(t){return(0,m.mG)(this,void 0,void 0,function*(){if(console.log(t),null!=t){const r={id:t.id,dateExchange:t.dateExchange,observations:t.observations,delivered:t.delivered,agency:{id:t.agency.id},gift:{id:t.gift.id}};return new Promise(d=>{this.http.post(this.URLDatabase+this.endpoint,r).subscribe(s=>{t.id=s.id,d(t)},s=>{console.log(s),d(null)})})}})}delete(t){return(0,m.mG)(this,void 0,void 0,function*(){if(null!=t){const r={id:t.id};return new Promise(d=>{this.http.delete(this.URLDatabase+this.endpoint,{body:r}).subscribe(()=>{d(!0)},s=>{console.log(s),d(!1)})})}})}}return g.\u0275fac=function(t){return new(t||g)(v.LFG(n.eN))},g.\u0275prov=v.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},195:(T,Z,l)=>{l.r(Z),l.d(Z,{GiftListPageModule:()=>C});var m=l(8816),b=l(6019),v=l(9010),n=l(2651),L=l(8725),g=l(4762),_=l(2112),t=l(865),r=l(4483),d=l(371),s=l(9311);function f(o,h){if(1&o){const i=t.EpF();t.TgZ(0,"ion-buttons",11),t.TgZ(1,"ion-text"),t._uU(2,"Tus Puntos Actuales :"),t.qZA(),t.TgZ(3,"ion-card"),t.TgZ(4,"ion-text"),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"ion-icon",12),t.NdJ("click",function(){return t.CHM(i),t.oxw().logout()}),t.qZA(),t.qZA()}if(2&o){const i=t.oxw();t.xp6(5),t.Oqu(i.actualpoints)}}function G(o,h){if(1&o){const i=t.EpF();t.TgZ(0,"ion-col",13),t.TgZ(1,"ion-item",14),t.TgZ(2,"ion-label",15),t.TgZ(3,"div",16),t.TgZ(4,"ion-card",17),t._UZ(5,"ion-img",18),t.qZA(),t.qZA(),t.TgZ(6,"div",16),t.TgZ(7,"div"),t.TgZ(8,"h2",19),t._uU(9),t.qZA(),t.TgZ(10,"ion-text",19),t.TgZ(11,"p"),t._uU(12),t.qZA(),t.qZA(),t.TgZ(13,"ion-button",20),t.NdJ("click",function(){const c=t.CHM(i).$implicit;return t.oxw().buy(c)}),t._uU(14,"Canjear Regalo "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const i=h.$implicit;t.xp6(5),t.MGl("src","https://res.cloudinary.com/duq0pz1vi/image/upload/v1645471738/",i.picture,""),t.xp6(4),t.Oqu(i.name),t.xp6(3),t.hij("Precio: ",i.points," Puntos")}}const M=[{path:"",component:(()=>{class o{constructor(i,e,a,c,p){this.gs=i,this.modalCtrl=e,this.uts=a,this.pt=c,this.ats=p,this.searchStr="",this.gifts=[],this.oldGifts=[],this.actualpoints=-1}ngOnInit(){}ionViewWillEnter(){return(0,g.mG)(this,void 0,void 0,function*(){console.log(this.gs.added),this.gs.added?(this.reset(null),this.gs.added=!1):(this.niTems=Math.ceil(this.pt.height()/20+10),yield this.loadgifts())})}loadgifts(i){return(0,g.mG)(this,void 0,void 0,function*(){let e=[];0==this.gifts.length&&(yield this.uts.presentLoading(),this.infinite.disabled=!1,e=yield this.gs.getByAvailablePaged(!0,this.niTems,0),this.gifts=this.gifts.concat(e),this.oldGifts=this.oldGifts.concat(this.gifts),this.actualpoints=this.ats.agency.points),e.length<this.niTems&&(this.infinite.disabled=!0),i&&i.target.complete(),yield this.uts.hideLoading()})}infiniteLoad(i){return(0,g.mG)(this,void 0,void 0,function*(){let e=[];this.infinite.disabled||(e=yield this.gs.getByAvailablePaged(!0,this.niTems,this.gifts.length),this.gifts=this.gifts.concat(e),this.oldGifts=this.oldGifts.concat(e),e.length<this.niTems&&(this.infinite.disabled=!0)),this.infinite.complete()})}reset(i){return(0,g.mG)(this,void 0,void 0,function*(){this.infinite.disabled=!1,this.gifts=[],this.loadgifts(i)})}logout(){this.ats.logout()}buy(i){return(0,g.mG)(this,void 0,void 0,function*(){let e;try{const a=yield this.modalCtrl.create({component:_.c,cssClass:"fullscreen",componentProps:{giftsaw:i}});yield a.present();const c=yield a.onDidDismiss();if(null!=c.data){let p=this.gifts.indexOf(i);this.gifts[p]=c.data.newGift,e=c.data.nagency,this.actualpoints=this.ats.agency.points}}catch(a){console.log(a)}})}searchChange(){return(0,g.mG)(this,void 0,void 0,function*(){this.searchStr=this.sb.value;let i=new RegExp("^[ ]");try{if(this.searchStr.match(i))this.uts.presentToast("La b\xfasqueda no puede comenzar por espacios en blanco.","danger","ban");else{let e=[],c=[];this.gifts=[];let p=this.searchStr.length;p>0?(yield this.uts.presentLoading(),c=yield this.gs.getByNamePaged(this.searchStr,9999,0),c.forEach(u=>{let P=!0;e.forEach(y=>{(y.id==u.id||0==y.available)&&(P=!1)}),P&&e.push(u)}),+this.searchStr>=0&&(c=yield this.gs.getByPoints(this.searchStr),c.forEach(u=>{let P=!0;e.forEach(y=>{(y.id==u.id||0==y.available)&&(P=!1)}),P&&e.push(u)})),e.forEach(u=>{u.available||e.splice(e.indexOf(u),1)}),this.gifts=e,this.infinite.disabled=!0,yield this.uts.hideLoading()):p<1&&(yield this.uts.presentLoading(),this.gifts=this.oldGifts,this.infinite.disabled=this.oldInfinite,yield this.uts.hideLoading())}}catch(e){}})}sortList(i){return null!=i&&i.length>1&&(i=i.sort((e,a)=>e.name>a.name?1:e.name<a.name?-1:e.id>a.id?1:e.id<a.id?-1:0)),i}}return o.\u0275fac=function(i){return new(i||o)(t.Y36(r.R),t.Y36(n.IN),t.Y36(d.f),t.Y36(n.t4),t.Y36(s.e))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-gift-list"]],viewQuery:function(i,e){if(1&i&&(t.Gf(n.ju,5),t.Gf(n.VI,5)),2&i){let a;t.iGM(a=t.CRH())&&(e.infinite=a.first),t.iGM(a=t.CRH())&&(e.sb=a.first)}},decls:18,vars:4,consts:[[3,"translucent"],["color","medium"],["style","margin-right: 1%;","slot","end",4,"ngIf"],[1,"ion-align-items-center"],["placeholder","Escribe para encuentrar el Articulo que est\xe1s buscando...","inputmode","text","type","text","showCancelButton","always",3,"ionChange"],[2,"background-color","white",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"body"],["sizeLg","4","sizeMd","4",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText",""],["slot","end",2,"margin-right","1%"],["slot","end","name","log-out-outline",1,"ico",2,"zoom","1.7","cursor","pointer",3,"click"],["sizeLg","4","sizeMd","4"],["color","black"],[1,"shopbox"],[1,"center"],[1,"imcage"],[1,"image",3,"src"],[1,"ion-text-center"],["sizeSm","1.3","sizeMd","1.3","sizeLg","1.3","color","medium",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"ion-header",0),t.TgZ(1,"ion-toolbar",1),t.TgZ(2,"ion-title"),t._uU(3,"Articulos Disponibles"),t.qZA(),t.YNc(4,f,7,1,"ion-buttons",2),t.qZA(),t.TgZ(5,"ion-toolbar",1),t.TgZ(6,"ion-row",3),t.TgZ(7,"ion-col"),t.TgZ(8,"ion-searchbar",4),t.NdJ("ionChange",function(){return e.searchChange()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"ion-content",5),t.TgZ(10,"ion-refresher",6),t.NdJ("ionRefresh",function(c){return e.reset(c)}),t._UZ(11,"ion-refresher-content"),t.qZA(),t.TgZ(12,"div",7),t.TgZ(13,"ion-grid"),t.TgZ(14,"ion-row"),t.YNc(15,G,15,3,"ion-col",8),t.qZA(),t.qZA(),t.TgZ(16,"ion-infinite-scroll",9),t.NdJ("ionInfinite",function(c){return e.infiniteLoad(c)}),t._UZ(17,"ion-infinite-scroll-content",10),t.qZA(),t.qZA(),t.qZA()),2&i&&(t.Q6J("translucent",!1),t.xp6(4),t.Q6J("ngIf",e.actualpoints>-1),t.xp6(5),t.Q6J("fullscreen",!0),t.xp6(6),t.Q6J("ngForOf",e.gifts))},directives:[n.Gu,n.sr,n.wd,b.O5,n.Nd,n.wI,n.VI,n.j9,n.W2,n.nJ,n.Wo,n.jY,b.sg,n.ju,n.MB,n.Sm,n.yW,n.PM,n.gu,n.Ie,n.Q$,n.Xz,n.YG],styles:["ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#4b4b4d!important}.header-row[_ngcontent-%COMP%]{border-radius:0%;border:0px}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{text-align:center}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#fff!important;font-size:1.2rem;text-align:center}.row[_ngcontent-%COMP%]{color:#fff;font-size:1.1rem}.ico[_ngcontent-%COMP%]{color:#fff}.body[_ngcontent-%COMP%]{background:#d0e5f0!important;background-size:cover;min-height:100%;color:#4b4b4d}ion-content[_ngcontent-%COMP%]{--background: #f5fbfe}.leftside[_ngcontent-%COMP%]{margin-left:5%;width:30%;float:left;height:15rem;display:table}.list[_ngcontent-%COMP%]{background:#d0e5f0!important}.rightside[_ngcontent-%COMP%]{width:65%;float:right;height:15rem;text-align:center;display:table}.imcage[_ngcontent-%COMP%]{width:15rem;max-width:200px;height:15rem;vertical-align:middle}.image[_ngcontent-%COMP%]{width:100%;max-width:200px;height:15rem;vertical-align:middle;box-shadow:inset;border-radius:25%}.shopbox[_ngcontent-%COMP%]{background-color:#fff!important;border:1px solid #b3b3b3;border-radius:25px;padding-top:7%!important;padding-bottom:7%!important}ion-item[_ngcontent-%COMP%]{--inner-border-width: 0}"]}),o})()}];let A=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[L.Bz.forChild(M)],L.Bz]}),o})(),C=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[b.ez,v.u5,n.Pc,A,m.h,v.UX]]}),o})()}}]);