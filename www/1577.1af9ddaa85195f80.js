"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1577],{1577:(M,c,o)=>{o.r(c),o.d(c,{CarRepairCreatePageModule:()=>b});var g=o(6019),n=o(9010),i=o(2651),u=o(8725),p=o(4762),m=o(5764),C=o(6092),e=o(865),Z=o(7928),h=o(371),f=o(9311),T=o(9574),v=o(1249);function A(t,s){if(1&t){const r=e.EpF();e.TgZ(0,"ion-datetime",23,24),e.NdJ("ionChange",function(){e.CHM(r);const l=e.MAs(1);return e.oxw().changeDateRepair(l.value)}),e.TgZ(2,"ion-buttons",25),e.TgZ(3,"ion-button",26),e.NdJ("click",function(){return e.CHM(r),e.oxw().confirm()}),e._uU(4,"Aceptar"),e.qZA(),e.TgZ(5,"ion-button",26),e.NdJ("click",function(){return e.CHM(r),e.oxw().reset()}),e._uU(6,"Cancelar"),e.qZA(),e.qZA(),e.qZA()}if(2&t){const r=e.oxw();e.Q6J("value",r.stringDateOrder)}}function S(t,s){1&t&&(e.TgZ(0,"span",27),e._uU(1," Debe rellenar este campo "),e.qZA())}function R(t,s){1&t&&(e.TgZ(0,"span",27),e._uU(1," Debe rellenar este campo "),e.qZA())}function q(t,s){1&t&&(e.TgZ(0,"span",27),e._uU(1," Debe rellenar este campo "),e.qZA())}function y(t,s){1&t&&(e.TgZ(0,"span",27),e._uU(1," Debe rellenar este campo "),e.qZA())}const P=[{path:"",component:(()=>{class t{constructor(r,a,l,d,U,I,N,D){this.carRepairService=r,this.formBuilder=a,this.pickerController=l,this.utilService=d,this.authService=U,this.agencyService=I,this.dateTimeService=N,this.router=D,this.dateValue="",this.createFormGroup()}ngOnInit(){this.getMyAgency(),this.setDate()}onSubmit(){this.create()}create(){return(0,p.mG)(this,void 0,void 0,function*(){if(this.utilService.presentLoading(),null!=this.myAgency){let r={operation:0,carPlate:this.formCarRepair.get("carPlate").value,model:this.formCarRepair.get("model").value,brandCar:this.formCarRepair.get("brandCar").value,clienteName:this.formCarRepair.get("clienteName").value,dateOrder:this.formatedString,nor:0,amount:0,dateRepair:null,asigPoints:0,repaired:!1,myAgency:this.myAgency};r=yield this.carRepairService.createOrUpdate(r),r.id?(this.formCarRepair.reset(),this.utilService.presentToast("La reparaci\xf3n se ha guardado correctamente","success"),this.carRepairService.added=!0,this.routeCarRepairList()):this.utilService.presentToast("Ha surgido un error al intentar crear la reparacion","danger"),this.utilService.hideLoading()}})}getMyAgency(){return(0,p.mG)(this,void 0,void 0,function*(){let r;try{this.utilService.presentLoading(),r=yield this.agencyService.getByUserNamePaged(this.authService.user.name,100,0),r.length>0&&r.forEach(a=>{a.myUser.id==this.authService.user.id&&(this.myAgency=a,this.utilService.hideLoading())})}catch(a){this.utilService.presentToast("Fallo al cargar","danger")}})}createFormGroup(){this.formCarRepair=this.formBuilder.group({carPlate:["",n.kI.required],model:["",n.kI.required],brandCar:["",n.kI.required],clienteName:["",n.kI.required],dateOrder:["",n.kI.required],myAgency:[this.authService.user.id,n.kI.required]})}get errorControl(){return this.formCarRepair.controls}confirm(){this.datetime.confirm(!0)}reset(){this.datetime.cancel(!0)}setDate(){let r=new Date(Date.now());this.spanishDateOrder=this.dateTimeService.formatSpanishDateString(r.toISOString()),this.formatedString=this.dateTimeService.formatString(r.toISOString())}changeDateRepair(r){this.spanishDateOrder=this.dateTimeService.formatSpanishDateString(r),this.stringDateOrder=this.dateTimeService.formatString(r),this.dateValue=r,this.formatedString=this.formatDate(this.dateValue)}formatDate(r){return(0,m.Z)((0,C.Z)(r),"yyyy-MM-dd HH:mm:SS")}routeCarRepairList(){this.router.navigateByUrl("tab-user/car-repair/list")}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(Z.K),e.Y36(n.qu),e.Y36(i.up),e.Y36(h.f),e.Y36(f.e),e.Y36(T.Y),e.Y36(v.Y),e.Y36(u.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-car-repair-create"]],viewQuery:function(r,a){if(1&r&&(e.Gf(i.ho,5),e.Gf(i.x4,5)),2&r){let l;e.iGM(l=e.CRH())&&(a.toggle=l.first),e.iGM(l=e.CRH())&&(a.datetime=l.first)}},decls:53,vars:8,consts:[[3,"translucent"],["color","primary"],[3,"fullscreen"],[1,"body"],[1,"ion-padding",3,"formGroup","ngSubmit"],[1,"formulario"],[1,"ion-align-items-center"],["sizeSm","3.2","sizeLg","3.2"],["button","true","id","open-date-input"],["slot","end"],["trigger","open-date-input","show-backdrop","false"],["sizeSm","2","sizeLg","2"],["sizeSm","11","sizeLg","10"],["type","text","formControlName","carPlate","required","true",1,"customInput"],["class","invalid",4,"ngIf"],["sizeSm","5","sizeLg","10"],["type","text","formControlName","model","required","true",1,"customInput"],["type","text","formControlName","brandCar","required","true",1,"customInput"],["sizeSm","10","sizeLg","10"],["type","text","formControlName","clienteName","required","true",1,"customInput"],["size","6"],["expand","block","shape","round",1,"button",2,"margin-top","2% !important",3,"click"],["expand","block","type","submit","shape","round",1,"button",2,"margin-top","2% !important"],["color","secondary",3,"value","ionChange"],["popoverDatetime",""],["slot","buttons"],["shape","round",1,"button",3,"click"],[1,"invalid"]],template:function(r,a){1&r&&(e.TgZ(0,"ion-header",0),e.TgZ(1,"ion-toolbar",1),e.TgZ(2,"ion-title"),e._uU(3,"Crear Reparaci\xf3n"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(4,"ion-content",2),e.TgZ(5,"div",3),e.TgZ(6,"form",4),e.NdJ("ngSubmit",function(){return a.create()}),e.TgZ(7,"div",5),e.TgZ(8,"ion-grid"),e.TgZ(9,"ion-row",6),e.TgZ(10,"ion-col",7),e.TgZ(11,"ion-item",8),e.TgZ(12,"ion-label"),e._uU(13,"Fecha de alta:"),e.qZA(),e.TgZ(14,"ion-text",9),e._uU(15),e.qZA(),e.TgZ(16,"ion-popover",10),e.YNc(17,A,7,1,"ng-template"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"ion-row",6),e.TgZ(19,"ion-col",11),e.TgZ(20,"ion-label"),e._uU(21,"Matr\xedcula"),e.qZA(),e.qZA(),e.TgZ(22,"ion-col",12),e._UZ(23,"ion-input",13),e.YNc(24,S,2,0,"span",14),e.qZA(),e.qZA(),e.TgZ(25,"ion-row",6),e.TgZ(26,"ion-col",11),e.TgZ(27,"ion-label"),e._uU(28,"Modelo"),e.qZA(),e.qZA(),e.TgZ(29,"ion-col",15),e._UZ(30,"ion-input",16),e.YNc(31,R,2,0,"span",14),e.qZA(),e.qZA(),e.TgZ(32,"ion-row",6),e.TgZ(33,"ion-col",11),e.TgZ(34,"ion-label"),e._uU(35,"Marca"),e.qZA(),e.qZA(),e.TgZ(36,"ion-col",15),e._UZ(37,"ion-input",17),e.YNc(38,q,2,0,"span",14),e.qZA(),e.qZA(),e.TgZ(39,"ion-row",6),e.TgZ(40,"ion-col",11),e.TgZ(41,"ion-label"),e._uU(42,"Cliente"),e.qZA(),e.qZA(),e.TgZ(43,"ion-col",18),e._UZ(44,"ion-input",19),e.YNc(45,y,2,0,"span",14),e.qZA(),e.qZA(),e.TgZ(46,"ion-row",6),e.TgZ(47,"ion-col",20),e.TgZ(48,"ion-button",21),e.NdJ("click",function(){return a.routeCarRepairList()}),e._uU(49," Cancelar "),e.qZA(),e.qZA(),e.TgZ(50,"ion-col",20),e.TgZ(51,"ion-button",22),e._uU(52," Guardar "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&r&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(2),e.Q6J("formGroup",a.formCarRepair),e.xp6(9),e.Oqu(a.spanishDateOrder),e.xp6(9),e.Q6J("ngIf",null==a.errorControl.carPlate.errors?null:a.errorControl.carPlate.errors.required),e.xp6(7),e.Q6J("ngIf",null==a.errorControl.model.errors?null:a.errorControl.model.errors.required),e.xp6(7),e.Q6J("ngIf",null==a.errorControl.brandCar.errors?null:a.errorControl.brandCar.errors.required),e.xp6(7),e.Q6J("ngIf",null==a.errorControl.clienteName.errors?null:a.errorControl.clienteName.errors.required))},directives:[i.Gu,i.sr,i.wd,i.W2,n._Y,n.JL,n.sg,i.jY,i.Nd,i.wI,i.Ie,i.Q$,i.yW,i.d8,i.pK,i.j9,n.JJ,n.u,n.Q7,g.O5,i.YG,i.x4,i.QI,i.Sm],styles:[""]}),t})()}];let _=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[u.Bz.forChild(P)],u.Bz]}),t})(),b=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[g.ez,n.u5,i.Pc,_,n.u5,n.UX]]}),t})()}}]);