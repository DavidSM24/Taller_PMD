{"version":3,"file":"default-src_app_user_carRepair_car-repair-update_car-repair-update_page_ts.js","mappings":"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","sources":["./src/app/user/carRepair/car-repair-update/car-repair-update.page.ts","./src/app/user/carRepair/car-repair-update/car-repair-update.page.html"],"sourcesContent":["import { Component, Input, OnInit, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { IonDatetime, ModalController } from '@ionic/angular';\r\nimport { format, parseISO } from 'date-fns';\r\nimport { CarRepair } from 'src/app/models/CarRepair';\r\nimport { CarRepairService } from 'src/app/services/car-repair.service';\r\nimport { DateTimeServiceService } from 'src/app/services/date-time-service.service';\r\nimport { UtilService } from 'src/app/services/util.service';\r\n\r\n@Component({\r\n  selector: 'app-car-repair-update',\r\n  templateUrl: './car-repair-update.page.html',\r\n  styleUrls: ['./car-repair-update.page.scss'],\r\n})\r\nexport class CarRepairUpdatePage implements OnInit {\r\n\r\n  @Input() carRepair: CarRepair;\r\n  //variables para la fecha\r\n  @ViewChild(IonDatetime) datetime: IonDatetime;\r\n  //Guarda la fecha con el formato de españa\r\n  public spanishDateOrder: string;\r\n\r\n  //Guarda la fecha de la reparación con el formato de españa\r\n  public spanishDateRepair: string;\r\n  //Guarda la fecha de la reparación con un formato legible para el ion-dateTime\r\n  public stringDateOrder: string;\r\n  //variable que guarda los datos proporcionados por el evento del ion-dateTime\r\n  public dateValue = '';\r\n  //Variable que guarda la fecha de reparación con el formato correcto para ser enviado a la api\r\n  public formatedString;\r\n  public formCarRepair: FormGroup;\r\n  public id: number;\r\n  private newCarRepair: CarRepair;\r\n  constructor(\r\n    private modalController: ModalController,\r\n    private carRepairService: CarRepairService,\r\n    private formBuilder: FormBuilder,\r\n    private uts: UtilService,\r\n    private dateTimeService: DateTimeServiceService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    //se crea la fecha en formato español\r\n    if (this.carRepair.dateOrder) {\r\n      this.spanishDateOrder = this.dateTimeService.formatSpanishDateString(\"\" + this.carRepair.dateOrder);\r\n      this.formatedString = this.dateTimeService.formatString(\"\" + this.carRepair.dateOrder);\r\n\r\n    }\r\n    //compruba si exite una fecha de reparación previa, en caso de que exista se preparan las variables para mostrarlas en el html\r\n    if (this.carRepair.dateRepair) {\r\n      this.spanishDateRepair = this.dateTimeService.formatSpanishDateString(\"\" + this.carRepair.dateRepair);\r\n    }\r\n\r\n    this.formCarRepair = this.formBuilder.group({\r\n\r\n      carPlate: [this.carRepair.carPlate.toUpperCase(), [Validators.required, Validators.minLength(4), Validators.maxLength(10)]],\r\n      model: [this.carRepair.model, [Validators.required, Validators.minLength(2),Validators.maxLength(50)]],\r\n      brandCar: [this.carRepair.brandCar, [Validators.required, Validators.minLength(2), Validators.maxLength(50)]],\r\n      clienteName: [this.carRepair.clienteName, [Validators.required, Validators.minLength(2), Validators.maxLength(50)]],\r\n      dateOrder: [this.carRepair.dateOrder, [Validators.required]],\r\n      //esta variable solo se usa para mostrar la fecha de la orden con el formato de España en el html\r\n      spanishDateRepair: [this.spanishDateRepair],\r\n\r\n\r\n    });\r\n  }\r\n\r\n  /**\r\n  * Método que guarda la nota una vez editada\r\n  */\r\n  public async editCarRepair() {\r\n\r\n    //se asigna los datos\r\n    this.newCarRepair = {\r\n\r\n      id: this.carRepair.id,\r\n      operation: this.carRepair.operation,\r\n      carPlate: this.formCarRepair.get(\"carPlate\").value,\r\n      model: this.formCarRepair.get(\"model\").value,\r\n      brandCar: this.formCarRepair.get(\"brandCar\").value,\r\n      clienteName: this.formCarRepair.get(\"clienteName\").value,\r\n      dateOrder: this.formatedString,\r\n      nor: this.carRepair.nor,\r\n      amount: this.carRepair.amount,\r\n      dateRepair: this.carRepair.dateRepair,\r\n      asigPoints: this.carRepair.asigPoints,\r\n      repaired: this.carRepair.repaired,\r\n      myAgency: this.carRepair.myAgency\r\n\r\n    }\r\n    \r\n    try {\r\n      //Guarda la reparación en la base de datos\r\n      this.newCarRepair = await this.carRepairService.createOrUpdate(this.newCarRepair);\r\n      //presenta el toast para que el usuario sepa que se ha guardado con  éxito\r\n      await this.uts.presentToast(\"Reparación modificada correctamente.\", \"success\", \"checkmark-circle-outline\");\r\n\r\n      //Cierra el modal pasando la reparación guardada a la página con las reparaciones\r\n      this.modalController.dismiss({\r\n        newCarRepair: this.newCarRepair\r\n      })\r\n\r\n    } catch (error) {\r\n      this.uts.presentToast(\"Fallo al guradar\", \"danger\", 'ban');\r\n      \r\n    }\r\n  }\r\n\r\n  /**\r\n  * Método para cerrar el modal\r\n  */\r\n  public closeModal() {\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  //Métodos para cerrar y abrir el modal de DateTime\r\n  /**\r\n  * Metodo que se usa en el ion-DateTime para confirmar la fecha elegida\r\n  */\r\n  confirm() {\r\n    this.datetime.confirm(true);\r\n  }\r\n  /**\r\n   * Método que se usa en ion-DateTime para cerrar la ventana\r\n   */\r\n  reset() {\r\n    this.datetime.cancel(true);\r\n  }\r\n\r\n  ////Métodos para cambiar la fecha\r\n  /**\r\n  * Método que asigna la fecha de reparación cuando el usuario pulsa el botón de aceptar en el ión date time\r\n  * @param event\r\n  */\r\n  changeDateRepair(event) {\r\n    this.spanishDateOrder = this.dateTimeService.formatSpanishDateString(event);\r\n    this.stringDateOrder = this.dateTimeService.formatString(event);\r\n    this.dateValue = event;\r\n    this.formatedString = this.formatDate(this.dateValue);\r\n\r\n  }\r\n  /**\r\n* Metodo para darle formato a la fecha y que se pueda guardar en la base de datos\r\n* @param value\r\n* @returns fecha con el formato yyyy-MM-ddTHH:mm\r\n*/\r\n  formatDate(value: string): string {\r\n    return format(parseISO(value), 'yyyy-MM-dd HH:mm:SS');\r\n  }\r\n}\r\n","export default \"<ion-header [translucent]=\\\"true\\\">\\r\\n  <ion-toolbar color=\\\"medium\\\">\\r\\n    <ion-title>Editar Reparación</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content   [fullscreen]=\\\"true\\\">\\r\\n  <div  class=\\\"body\\\">\\r\\n    <form [formGroup]=\\\"formCarRepair\\\" class=\\\"ion-padding\\\">\\r\\n      <div  class=\\\"formulario\\\">\\r\\n        <ion-grid color=\\\"medium\\\">\\r\\n\\r\\n          <ion-row class=\\\"ion-align-items-center\\\" style=\\\"margin-left:-2% !important;\\\">\\r\\n\\r\\n            <ion-col >\\r\\n\\r\\n              <ion-item button=\\\"true\\\" id=\\\"open-date-input\\\">\\r\\n                <ion-text>Fecha de Alta:   {{ spanishDateOrder }}</ion-text>\\r\\n                <ion-popover trigger=\\\"open-date-input\\\" show-backdrop=\\\"false\\\">\\r\\n                  <ng-template>\\r\\n                    <ion-datetime color=\\\"secondary\\\" #popoverDatetime [value]=\\\"stringDateOrder\\\"\\r\\n                      (ionChange)=\\\"changeDateRepair(popoverDatetime.value)\\\">\\r\\n                      <ion-buttons slot=\\\"buttons\\\">\\r\\n                        <ion-button shape=\\\"round\\\" class=\\\"button\\\" (click)=\\\"confirm()\\\">Aceptar</ion-button>\\r\\n                        <ion-button shape=\\\"round\\\" class=\\\"button\\\" (click)=\\\"reset()\\\">Cancelar</ion-button>\\r\\n                      </ion-buttons>\\r\\n                    </ion-datetime>\\r\\n                  </ng-template>\\r\\n                </ion-popover>\\r\\n              </ion-item>\\r\\n            </ion-col>\\r\\n          </ion-row>\\r\\n\\r\\n          <ion-row class=\\\"ion-align-items-center\\\">\\r\\n            <ion-col sizeSm=\\\"2\\\" sizeLg=\\\"2\\\">\\r\\n              <ion-label>Matrícula</ion-label>\\r\\n            </ion-col>\\r\\n            <ion-col sizeSm=\\\"11\\\" sizeLg=\\\"10\\\">\\r\\n              <ion-input class=\\\"customInput\\\" type=\\\"text\\\" style=\\\"text-transform: uppercase\\\" formControlName=\\\"carPlate\\\" required=\\\"true\\\"></ion-input>\\r\\n              <span class=\\\"invalid\\\" *ngIf=\\\"this.formCarRepair.get('carPlate').invalid&&formCarRepair.get('carPlate').touched\\\">\\r\\n                *Debe rellenar este campo. Introduzca entre 4 y 10 caracteres.\\r\\n              </span>\\r\\n            </ion-col>\\r\\n\\r\\n          </ion-row>\\r\\n\\r\\n          <ion-row class=\\\"ion-align-items-center\\\">\\r\\n            <ion-col sizeSm=\\\"2\\\" sizeLg=\\\"2\\\">\\r\\n              <ion-label>Modelo</ion-label>\\r\\n            </ion-col>\\r\\n            <ion-col sizeSm=\\\"5\\\" sizeLg=\\\"10\\\">\\r\\n              <ion-input class=\\\"customInput\\\" type=\\\"text\\\" formControlName=\\\"model\\\" required=\\\"true\\\"></ion-input>\\r\\n              <span class=\\\"invalid\\\" *ngIf=\\\"this.formCarRepair.get('model').invalid&&formCarRepair.get('model').touched\\\">\\r\\n                *Debe rellenar este campo. Introduzca entre 2 y 50 caracteres.\\r\\n              </span>\\r\\n            </ion-col>\\r\\n          </ion-row>\\r\\n\\r\\n          <ion-row class=\\\"ion-align-items-center\\\">\\r\\n            <ion-col sizeSm=\\\"2\\\" sizeLg=\\\"2\\\">\\r\\n              <ion-label>Marca</ion-label>\\r\\n            </ion-col>\\r\\n            <ion-col sizeSm=\\\"5\\\" sizeLg=\\\"10\\\">\\r\\n              <ion-input class=\\\"customInput\\\" type=\\\"text\\\" formControlName=\\\"brandCar\\\" required=\\\"true\\\"></ion-input>\\r\\n              <span class=\\\"invalid\\\" *ngIf=\\\"this.formCarRepair.get('brandCar').invalid&&formCarRepair.get('brandCar').touched\\\">\\r\\n                *Debe rellenar este campo. Introduzca entre 2 y 50 caracteres.\\r\\n              </span>\\r\\n            </ion-col>\\r\\n          </ion-row>\\r\\n\\r\\n          <ion-row class=\\\"ion-align-items-center\\\">\\r\\n            <ion-col sizeSm=\\\"2\\\" sizeLg=\\\"2\\\">\\r\\n              <ion-label>Cliente</ion-label>\\r\\n            </ion-col>\\r\\n            <ion-col sizeSm=\\\"10\\\" sizeLg=\\\"10\\\">\\r\\n              <ion-input class=\\\"customInput\\\" type=\\\"text\\\" formControlName=\\\"clienteName\\\" required=\\\"true\\\"></ion-input>\\r\\n              <span class=\\\"invalid\\\" *ngIf=\\\"this.formCarRepair.get('clienteName').invalid&&formCarRepair.get('clienteName').touched\\\">\\r\\n                *Debe rellenar este campo. Introduzca entre 2 y 50 caracteres.\\r\\n              </span>\\r\\n            </ion-col>\\r\\n          </ion-row>\\r\\n\\r\\n          <ion-row class=\\\"ion-align-items-center\\\">\\r\\n            <ion-col sizeSm=\\\"7\\\" sizeLg=\\\"2\\\">\\r\\n              Reparado\\r\\n            </ion-col>\\r\\n            <ion-col sizeSm=\\\"7\\\" sizeLg=\\\"4\\\">\\r\\n              <div title=\\\"Sin Reparar. Espere asignación de administradores.\\\">\\r\\n                <ion-icon *ngIf=\\\"!carRepair.repaired\\\" name=\\\"construct\\\" style=\\\"pointer-events: none;zoom:1.7;color: red;\\\"></ion-icon>\\r\\n              </div>\\r\\n            </ion-col>\\r\\n          </ion-row>\\r\\n\\r\\n          <ion-row class=\\\"ion-align-items-center\\\">\\r\\n\\r\\n            <ion-col size=\\\"6\\\">\\r\\n              <ion-button [disabled]=\\\"this.formCarRepair.invalid\\\" expand=\\\"block\\\" shape=\\\"round\\\" style=\\\"margin-top: 2% !important;\\\" (click)=\\\"editCarRepair()\\\"\\r\\n                class=\\\"button\\\">\\r\\n                Guardar\\r\\n              </ion-button>\\r\\n            </ion-col>\\r\\n\\r\\n            <ion-col size=\\\"6\\\">\\r\\n              <ion-button expand=\\\"block\\\" shape=\\\"round\\\" style=\\\"margin-top: 2% !important;\\\" (click)=\\\"closeModal()\\\"\\r\\n                class=\\\"button2\\\">\\r\\n                Cancelar\\r\\n              </ion-button>\\r\\n            </ion-col>\\r\\n\\r\\n          </ion-row>\\r\\n        </ion-grid>\\r\\n      </div>\\r\\n    </form>\\r\\n  </div>\\r\\n</ion-content>\\r\\n\";"],"names":[],"sourceRoot":"webpack:///"}