"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1141,922],{922:(T,P,l)=>{l.d(P,{y:()=>Z});var m=l(4762),p=l(8260),b=l(865),e=l(4522);let Z=(()=>{class g{constructor(t){this.http=t,this.endpoint="/exchangeGifts",this.URLDatabase=p.N.herokuConfig.url}getListData(t){return(0,m.mG)(this,void 0,void 0,function*(){let a=[];return new Promise(d=>{this.http.get(t).subscribe(s=>{if(null!=s&&s.length>0)for(let u of s)a.push({id:u.id,dateExchange:u.dateExchange,observations:u.observations,delivered:u.delivered,agency:u.agency,gift:u.gift});console.log(s),d(a)},s=>{console.log(s)})})})}getAllPaged(t,a){return this.getListData(this.URLDatabase+this.endpoint+"/element/"+t+"/page/"+a)}getAll(){return this.getListData(this.URLDatabase+this.endpoint)}getByDateFilter(t){return this.getListData(this.URLDatabase+this.endpoint+"/date/"+t)}getByPoints(t){return this.getListData(this.URLDatabase+this.endpoint+"/points/"+t)}getByAgencyUsername(t){return this.getListData(this.URLDatabase+this.endpoint+"/auname/"+t)}getById(t){return(0,m.mG)(this,void 0,void 0,function*(){let a=null;return new Promise(d=>{this.http.get(this.URLDatabase+this.endpoint+"/id/"+t).subscribe(s=>{s.id&&(a={id:s.id,dateExchange:s.dateExchange,observations:s.observations,delivered:s.delivered,agency:s.agency,gift:s.gift}),console.log(a),d(a)},s=>{console.log(s),console.log(a),d(a)})})})}getByDeliveredPaged(t,a,d){return this.getListData(this.URLDatabase+this.endpoint+"/delivered/"+t+"/element/"+a+"/paged/"+d)}getByGiftName(t){return this.getListData(this.URLDatabase+this.endpoint+"/gname/"+t)}getByAgencyPaged(t,a,d){if(null!=t)return this.getListData(this.URLDatabase+this.endpoint+"/id_agency/"+t.id+"/element/"+a+"/paged/"+d);{let s;return s}}createOrUpdate(t){return(0,m.mG)(this,void 0,void 0,function*(){if(console.log(t),null!=t){const a={id:t.id,dateExchange:t.dateExchange,observations:t.observations,delivered:t.delivered,agency:{id:t.agency.id},gift:{id:t.gift.id}};return new Promise(d=>{this.http.post(this.URLDatabase+this.endpoint,a).subscribe(s=>{t.id=s.id,d(t)},s=>{console.log(s),d(null)})})}})}delete(t){return(0,m.mG)(this,void 0,void 0,function*(){if(null!=t){const a={id:t.id};return new Promise(d=>{this.http.delete(this.URLDatabase+this.endpoint,{body:a}).subscribe(()=>{d(!0)},s=>{console.log(s),d(!1)})})}})}}return g.\u0275fac=function(t){return new(t||g)(b.LFG(e.eN))},g.\u0275prov=b.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},195:(T,P,l)=>{l.r(P),l.d(P,{GiftListPageModule:()=>A});var m=l(8816),p=l(6019),b=l(9010),e=l(2651),Z=l(8725),g=l(4762),y=l(2112),t=l(865),a=l(4483),d=l(371),s=l(9311);function u(r,h){if(1&r){const i=t.EpF();t.TgZ(0,"ion-buttons",11),t.TgZ(1,"ion-text"),t._uU(2,"Tus Puntos Actuales :"),t.qZA(),t.TgZ(3,"ion-card"),t.TgZ(4,"ion-text"),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"ion-icon",12),t.NdJ("click",function(){return t.CHM(i),t.oxw().logout()}),t.qZA(),t.qZA()}if(2&r){const i=t.oxw();t.xp6(5),t.Oqu(i.actualpoints)}}function L(r,h){if(1&r){const i=t.EpF();t.TgZ(0,"ion-col",13),t.TgZ(1,"ion-item",14),t.TgZ(2,"ion-label",15),t.TgZ(3,"div",16),t.TgZ(4,"ion-card",17),t._UZ(5,"ion-img",18),t.qZA(),t.qZA(),t.TgZ(6,"div",16),t.TgZ(7,"div"),t.TgZ(8,"h2",19),t._uU(9),t.qZA(),t.TgZ(10,"ion-text",19),t.TgZ(11,"p"),t._uU(12),t.qZA(),t.qZA(),t.TgZ(13,"ion-button",20),t.NdJ("click",function(){const c=t.CHM(i).$implicit;return t.oxw().buy(c)}),t._uU(14,"Canjear Regalo"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&r){const i=h.$implicit;t.xp6(5),t.MGl("src","https://res.cloudinary.com/duq0pz1vi/image/upload/v1645471738/",i.picture,""),t.xp6(4),t.Oqu(i.name),t.xp6(3),t.hij("Precio: ",i.points," Puntos")}}const G=[{path:"",component:(()=>{class r{constructor(i,n,o,c,f){this.gs=i,this.modalCtrl=n,this.uts=o,this.pt=c,this.ats=f,this.searchStr="",this.gifts=[],this.oldGifts=[],this.actualpoints=-1}ngOnInit(){}ionViewWillEnter(){return(0,g.mG)(this,void 0,void 0,function*(){console.log(this.gs.added),this.gs.added?(this.reset(null),this.gs.added=!1):(this.niTems=Math.ceil(this.pt.height()/20+10),yield this.loadgifts())})}loadgifts(i){return(0,g.mG)(this,void 0,void 0,function*(){let n=[];0==this.gifts.length&&(yield this.uts.presentLoading(),this.infinite.disabled=!1,n=yield this.gs.getAllPaged(this.niTems,0),this.gifts=this.gifts.concat(n),this.actualpoints=this.ats.agency.points),n.length<this.niTems&&(this.infinite.disabled=!0),i&&i.target.complete(),yield this.uts.hideLoading()})}infiniteLoad(i){return(0,g.mG)(this,void 0,void 0,function*(){let n=[];this.infinite.disabled||(n=yield this.gs.getAllPaged(this.niTems,this.gifts.length),this.gifts=this.gifts.concat(n),n.length<this.niTems&&(this.infinite.disabled=!0))})}reset(i){return(0,g.mG)(this,void 0,void 0,function*(){this.infinite.disabled=!1,this.gifts=[],this.loadgifts(i)})}logout(){this.ats.logout()}buy(i){return(0,g.mG)(this,void 0,void 0,function*(){let n;try{const o=yield this.modalCtrl.create({component:y.c,cssClass:"fullscreen",componentProps:{giftsaw:i}});yield o.present();const c=yield o.onDidDismiss();if(null!=c.data){let f=this.gifts.indexOf(i);this.gifts[f]=c.data.newGift,n=c.data.nagency,this.actualpoints=this.ats.agency.points}}catch(o){console.log(o)}})}searchChange(){return(0,g.mG)(this,void 0,void 0,function*(){let i=[];this.searchStr=this.sb.value;let o=[];this.gifts=[];let c=this.searchStr.length;c>0?(yield this.uts.presentLoading(),o=yield this.gs.getByNamePaged(this.searchStr,9999,0),o.forEach(f=>{let v=!0;i.forEach(_=>{_.id==f.id&&(v=!1)}),v&&i.push(f)}),+this.searchStr>=0?(o=yield this.gs.getByPoints(this.searchStr),o.forEach(f=>{let v=!0;i.forEach(_=>{_.id==f.id&&(v=!1)}),v&&i.push(f)})):this.gifts=i,this.infinite.disabled=!0,yield this.uts.hideLoading()):c<1&&(i=i.concat(this.oldGifts),this.infinite.disabled=this.oldInfinite,this.gifts=this.sortList(this.gifts),yield this.uts.hideLoading())})}sortList(i){return null!=i&&i.length>1&&(i=i.sort((n,o)=>n.name>o.name?1:n.name<o.name?-1:n.id>o.id?1:n.id<o.id?-1:0)),i}}return r.\u0275fac=function(i){return new(i||r)(t.Y36(a.R),t.Y36(e.IN),t.Y36(d.f),t.Y36(e.t4),t.Y36(s.e))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-gift-list"]],viewQuery:function(i,n){if(1&i&&(t.Gf(e.ju,5),t.Gf(e.VI,5)),2&i){let o;t.iGM(o=t.CRH())&&(n.infinite=o.first),t.iGM(o=t.CRH())&&(n.sb=o.first)}},decls:18,vars:4,consts:[[3,"translucent"],["color","medium"],["style","margin-right: 1%;","slot","end",4,"ngIf"],[1,"ion-align-items-center"],["placeholder","Escribe para encuentrar el Articulo que est\xe1s buscando...","inputmode","text","type","text","showCancelButton","always",3,"ionChange"],[2,"background-color","white",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"body"],["sizeLg","4","sizeMd","4",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText",""],["slot","end",2,"margin-right","1%"],["slot","end","name","log-out-outline",1,"ico",2,"zoom","1.7","cursor","pointer",3,"click"],["sizeLg","4","sizeMd","4"],["color","black"],[1,"shopbox"],[1,"center"],[1,"imcage"],[1,"image",3,"src"],[1,"ion-text-center"],["sizeSm","1.3","sizeMd","1.3","sizeLg","1.3","color","medium",3,"click"]],template:function(i,n){1&i&&(t.TgZ(0,"ion-header",0),t.TgZ(1,"ion-toolbar",1),t.TgZ(2,"ion-title"),t._uU(3,"Articulos Disponibles"),t.qZA(),t.YNc(4,u,7,1,"ion-buttons",2),t.qZA(),t.TgZ(5,"ion-toolbar",1),t.TgZ(6,"ion-row",3),t.TgZ(7,"ion-col"),t.TgZ(8,"ion-searchbar",4),t.NdJ("ionChange",function(){return n.searchChange()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"ion-content",5),t.TgZ(10,"ion-refresher",6),t.NdJ("ionRefresh",function(c){return n.reset(c)}),t._UZ(11,"ion-refresher-content"),t.qZA(),t.TgZ(12,"div",7),t.TgZ(13,"ion-grid"),t.TgZ(14,"ion-row"),t.YNc(15,L,15,3,"ion-col",8),t.qZA(),t.qZA(),t.TgZ(16,"ion-infinite-scroll",9),t.NdJ("ionInfinite",function(c){return n.infiniteLoad(c)}),t._UZ(17,"ion-infinite-scroll-content",10),t.qZA(),t.qZA(),t.qZA()),2&i&&(t.Q6J("translucent",!1),t.xp6(4),t.Q6J("ngIf",n.actualpoints>-1),t.xp6(5),t.Q6J("fullscreen",!0),t.xp6(6),t.Q6J("ngForOf",n.gifts))},directives:[e.Gu,e.sr,e.wd,p.O5,e.Nd,e.wI,e.VI,e.j9,e.W2,e.nJ,e.Wo,e.jY,p.sg,e.ju,e.MB,e.Sm,e.yW,e.PM,e.gu,e.Ie,e.Q$,e.Xz,e.YG],styles:["ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#4b4b4d!important}.header-row[_ngcontent-%COMP%]{border-radius:0%;border:0px}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{text-align:center}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#fff!important;font-size:1.2rem;text-align:center}.row[_ngcontent-%COMP%]{color:#fff;font-size:1.1rem}.ico[_ngcontent-%COMP%]{color:#fff}.body[_ngcontent-%COMP%]{background:#d0e5f0!important;background-size:cover;min-height:100%;color:#4b4b4d}ion-content[_ngcontent-%COMP%]{--background: #f5fbfe}.leftside[_ngcontent-%COMP%]{margin-left:5%;width:30%;float:left;height:15rem;display:table}.list[_ngcontent-%COMP%]{background:#d0e5f0!important}.rightside[_ngcontent-%COMP%]{width:65%;float:right;height:15rem;text-align:center;display:table}.imcage[_ngcontent-%COMP%]{width:15rem;max-width:200px;height:15rem;vertical-align:middle}.image[_ngcontent-%COMP%]{width:100%;max-width:200px;height:15rem;vertical-align:middle;box-shadow:inset;border-radius:25%}.shopbox[_ngcontent-%COMP%]{background-color:#fff!important;border:1px solid #b3b3b3;border-radius:25px;padding-top:7%!important;padding-bottom:7%!important}ion-item[_ngcontent-%COMP%]{--inner-border-width: 0}"]}),r})()}];let M=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[Z.Bz.forChild(G)],Z.Bz]}),r})(),A=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[p.ez,b.u5,e.Pc,M,m.h,b.UX]]}),r})()}}]);