{"version":3,"file":"src_app_login_login_module_ts.js","mappings":"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","sources":["./src/app/login/login-routing.module.ts","./src/app/login/login.module.ts","./src/app/login/login.page.ts","./src/app/login/login.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { LoginPageRoutingModule } from './login-routing.module';\r\n\r\nimport { LoginPage } from './login.page';\r\nimport { UserService } from '../services/user.service';\r\nimport { UtilService } from '../services/util.service';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    LoginPageRoutingModule,\r\n    FormsModule,\r\n    ReactiveFormsModule\r\n  ],\r\n  providers:[UserService,UtilService],\r\n  declarations: [LoginPage]\r\n})\r\nexport class LoginPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Router } from '@angular/router';\r\nimport { User } from '../models/User';\r\nimport { AuthService } from '../services/auth.service';\r\nimport { UserService } from '../services/user.service';\r\nimport { UtilService } from '../services/util.service';\r\nimport { Storage } from '@capacitor/storage';\r\nimport { Agency } from '../models/Agency';\r\nimport { AgencyService } from '../services/agency.service';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.page.html',\r\n  styleUrls: ['./login.page.scss'],\r\n})\r\nexport class LoginPage implements OnInit {\r\n\r\n  public formLogin: FormGroup;\r\n  public complete: boolean = false;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private us: UserService,\r\n    private uts: UtilService,\r\n    private authS: AuthService,\r\n    private router: Router,\r\n    private as: AgencyService) {\r\n\r\n    this.formLogin = this.fb.group({\r\n      code: [\"\", Validators.required, Validators.pattern(\"[0-9]*\")],\r\n      pass: [\"\", Validators.required]\r\n    });\r\n  }\r\n\r\n  async ngOnInit() {\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n\r\n    try {\r\n      if (this.authS.isLogged()) {\r\n        \r\n        try {\r\n          if (this.authS.user.administrator) {\r\n            this.uts.presentToast(\"Ha iniciado sesión con el usuario \" + this.authS.user.name + \".\", \"success\", \"person\");\r\n            this.router.navigate(['/tab-administrator/agency/list']);\r\n          }\r\n          else if (!this.authS.user.administrator) {\r\n            this.uts.presentToast(\"Ha iniciado sesión con el usuario \" + this.authS.user.name + \".\", \"success\", \"person\");\r\n            this.router.navigate(['/tab-user/gift/list']);\r\n          }\r\n        } catch (error) {\r\n\r\n        }\r\n\r\n      }\r\n      else this.complete = true;\r\n    } catch (error) {\r\n      \r\n    }\r\n\r\n  }\r\n\r\n  public async login() {\r\n\r\n    if (this.formLogin.get(\"code\").value == \"\" || this.formLogin.get(\"pass\").value == \"\") this.uts.presentToast(\"Debe rellenar todos los campos.\",\"danger\",\"ban\");\r\n    else {\r\n      let user: User\r\n      let correct: boolean = false;\r\n\r\n      await this.uts.presentLoading();\r\n      try {\r\n        let code = await this.formLogin.get(\"code\").value;\r\n        user = await this.us.getByCode(code);\r\n        if (user.id && this.formLogin.get(\"pass\").value == user.password) {\r\n          correct = true;\r\n\r\n        }\r\n        await this.uts.hideLoading();\r\n        if (correct) {\r\n          //iniciar sesión...\r\n\r\n          try {\r\n            this.authS.user = user;\r\n            await this.authS.keepSession();\r\n            \r\n\r\n            if (this.authS.user.administrator) {\r\n              this.router.navigate(['/tab-administrator/agency/list']);\r\n            }\r\n            else if (!this.authS.user.administrator) {\r\n              this.authS.agency = await this.as.getByUsercode(user.code);\r\n              \r\n              this.router.navigate(['/tab-user/gift/list']);\r\n            }\r\n          } catch (error) {\r\n            \r\n          }\r\n\r\n        }\r\n        else {\r\n          this.uts.presentToast(\"Usuario o contraseña incorrecta...\", \"danger\", 'ban')\r\n        }\r\n\r\n        await this.uts.hideLoading();\r\n      } catch (error) {\r\n        await this.uts.hideLoading();\r\n        this.uts.presentToast(\"Usuario o contraseña incorrecta...\", \"danger\", 'ban')\r\n      }\r\n    }\r\n\r\n\r\n\r\n  }\r\n\r\n}\r\n","export default \"  <ion-img *ngIf=\\\"!this.complete\\\" src=\\\"../../assets/images/logo nuevo_grande-01.jpg\\\" class=\\\"splash\\\"></ion-img>\\r\\n  <div *ngIf=\\\"this.complete\\\"  style=\\\"background-color: white; width: 100%; height: 100%;\\\">\\r\\n    <div>\\r\\n\\r\\n      <div class=\\\"login\\\">\\r\\n        <ion-img src=\\\"../../assets/images/logo.png\\\"></ion-img>\\r\\n        <form [formGroup]=\\\"formLogin\\\">\\r\\n          <h1>Login</h1>\\r\\n          <div class=\\\"group\\\">\\r\\n            <label for=\\\"code\\\" class=\\\"label\\\" style=\\\"margin-bottom:3% !important;\\\">Código</label>\\r\\n            <input (keyup.enter)=\\\"login()\\\" id=\\\"code\\\" type=\\\"number\\\" class=\\\"input\\\" formControlName=\\\"code\\\">\\r\\n          </div>\\r\\n          <div class=\\\"group\\\">\\r\\n            <label for=\\\"pass\\\" class=\\\"label\\\" style=\\\"margin-bottom:3% !important;\\\">Contraseña</label>\\r\\n            <input (keyup.enter)=\\\"login()\\\" id=\\\"pass\\\" type=\\\"password\\\" class=\\\"input\\\" data-type=\\\"pass\\\" formControlName=\\\"pass\\\">\\r\\n          </div>\\r\\n\\r\\n          <div class=\\\"wrapper\\\">\\r\\n            <div class=\\\"link_wrapper\\\">\\r\\n              <a (click)=\\\"login()\\\">Iniciar</a>\\r\\n              <div class=\\\"icon\\\">\\r\\n                <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 268.832 268.832\\\">\\r\\n                  <path d=\\\"M265.17 125.577l-80-80c-4.88-4.88-12.796-4.88-17.677 0-4.882 4.882-4.882 12.796 0 17.678l58.66 58.66H12.5c-6.903 0-12.5 5.598-12.5 12.5 0 6.903 5.597 12.5 12.5 12.5h213.654l-58.66 58.662c-4.88 4.882-4.88 12.796 0 17.678 2.44 2.44 5.64 3.66 8.84 3.66s6.398-1.22 8.84-3.66l79.997-80c4.883-4.882 4.883-12.796 0-17.678z\\\"/>\\r\\n                </svg>\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n          </div>\\r\\n\\r\\n        </form>\\r\\n\\r\\n\\r\\n\\r\\n      </div>\\r\\n\\r\\n    </div>\\r\\n  </div>\\r\\n\\r\\n\\r\\n\";"],"names":[],"sourceRoot":"webpack:///"}