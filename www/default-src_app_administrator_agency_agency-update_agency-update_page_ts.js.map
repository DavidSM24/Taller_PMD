{"version":3,"file":"default-src_app_administrator_agency_agency-update_agency-update_page_ts.js","mappings":"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","sources":["./src/app/administrator/agency/agency-update/agency-update.page.ts","./src/app/administrator/agency/agency-update/agency-update.page.html"],"sourcesContent":["import { Component, Input, OnInit, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { IonToggle, ModalController, PickerColumnOption, PickerController, PickerOptions } from '@ionic/angular';\r\nimport { AgencyService } from 'src/app/services/agency.service';\r\nimport { Agency } from '../../../models/Agency';\r\nimport { UtilService } from '../../../services/util.service';\r\nimport { InsuranceCompany } from '../../../models/InsuranceCompany';\r\nimport { InsuranceCompanyService } from 'src/app/services/insurance-company.service';\r\n\r\n@Component({\r\n  selector: 'app-agency-update',\r\n  templateUrl: './agency-update.page.html',\r\n  styleUrls: ['./agency-update.page.scss'],\r\n})\r\nexport class AgencyUpdatePage implements OnInit {\r\n\r\n  @ViewChild(IonToggle) toggle: IonToggle;\r\n  @Input() agency: Agency;\r\n\r\n  public insurance:InsuranceCompany=null;\r\n  public formAgency: FormGroup;\r\n  public companies: InsuranceCompany[];\r\n  public errorCompany:boolean;\r\n\r\n  constructor(\r\n    private modalCtrl: ModalController,\r\n    private fb: FormBuilder,\r\n    private as: AgencyService,\r\n    private uts:UtilService,\r\n    private is: InsuranceCompanyService,\r\n    private pickerController:PickerController,) {\r\n\r\n     }\r\n\r\n  ngOnInit() {\r\n\r\n    try {\r\n    this.insurance=this.agency.myInsuranceCompany;\r\n    //this.uts.presentLoading();\r\n\r\n    \r\n\r\n    this.formAgency = this.fb.group({\r\n      zipCode: [this.agency.zipCode,  [Validators.required, Validators.pattern(\"[0-9]{2,21}\")]],\r\n      address: [this.agency.address, [Validators.required,Validators.maxLength(50),Validators.minLength(4)]],\r\n      location: [this.agency.location, [Validators.required,Validators.maxLength(50),Validators.minLength(4)]],\r\n      phoneNumber: [this.agency.phoneNumber, [Validators.required,Validators.pattern(\"[0-9]{9}\")]],\r\n      points:[this.agency.points, Validators.required]\r\n\r\n    });\r\n\r\n    } catch (error) {\r\n      \r\n    }\r\n  }\r\n\r\n  async ionViewWillEnter() {\r\n\r\n\r\n    this.companies=await this.is.getAll();\r\n    if(this.companies.length<=0){\r\n      this.uts.presentToast('Para crear agencias, deben existir compañías de seguros.','danger','ban');\r\n    }\r\n    await this.uts.hideLoading();\r\n  }\r\n\r\n  public async edit() {\r\n\r\n    await this.uts.presentLoading();\r\n\r\n     let A: Agency = {\r\n       id: this.agency.id,\r\n       zipCode: this.formAgency.get(\"zipCode\").value,\r\n       address: this.formAgency.get(\"address\").value,\r\n       location: this.formAgency.get(\"location\").value,\r\n       phoneNumber: this.formAgency.get(\"phoneNumber\").value,\r\n       amount: this.agency.amount,\r\n       points: this.agency.points,\r\n       pointsRedeemed: this.agency.pointsRedeemed,\r\n       myInsuranceCompany: this.insurance,\r\n       myCarRepairs: this.agency.myCarRepairs,\r\n       myExchangesGifts: this.agency.myExchangesGifts,\r\n       myUser: this.agency.myUser,\r\n       active: this.toggle.checked\r\n     }\r\n\r\n     try {\r\n\r\n      A = await this.as.createOrUpdate(A);\r\n\r\n      await this.uts.hideLoading();\r\n\r\n      if(A.id){\r\n        this.uts.presentToast(\"Agencia modificada correctamente.\",\"success\",\"checkmark-circle-outline\");\r\n\r\n      }\r\n      else{\r\n        this.uts.presentToast(\"Ha surgido un error al intentar modificar la agencia. Compruebe todos los campos\",\"danger\",'ban');\r\n        A=null;\r\n      }\r\n\r\n     } catch (error) {\r\n       \r\n       this.uts.presentToast(\"Ha surgido un error al intentar modificar la agencia. Compruebe todos los campos\",\"danger\",'ban');\r\n       await this.uts.hideLoading();\r\n     }\r\n\r\n     if(A!=null) this.modalCtrl.dismiss({\r\n      newAgency:A\r\n        });\r\n      else this.modalCtrl.dismiss();\r\n\r\n  }\r\n\r\n  close() {\r\n    this.modalCtrl.dismiss();\r\n  }\r\n  async showPicker() {\r\n    let options: PickerOptions = {\r\n      buttons: [\r\n        {\r\n          text: \"Cancel\",\r\n          role: 'cancel',\r\n          handler: (value: any) => {\r\n            if(!this.insurance) this.errorCompany=true;\r\n          }\r\n        },\r\n        {\r\n          text:'Ok',\r\n          handler:(value:any) => {\r\n            this.insurance=value.Compañías.value;\r\n            this.errorCompany=false;\r\n          }\r\n        }\r\n      ],\r\n      columns:[{\r\n        name:'Compañías',\r\n        options:this.getColumnOptions()\r\n      }]\r\n    };\r\n\r\n    let picker = await this.pickerController.create(options);\r\n    picker.present()\r\n  }\r\n\r\n  getColumnOptions(){\r\n    let options = [];\r\n    this.companies.forEach(x => {\r\n      options.push({text:x.cia_Name,value:x});\r\n    });\r\n    return options;\r\n  }\r\n\r\n}\r\n\r\nexport interface PickerColumn {\r\n  name: string;\r\n  align?: string;\r\n  selectedIndex?: number;\r\n  prevSelected?: number;\r\n  prefix?: string;\r\n  suffix?: string;\r\n  options: PickerColumnOption[];\r\n  cssClass?: string | string[];\r\n  columnWidth?: string;\r\n  prefixWidth?: string;\r\n  suffixWidth?: string;\r\n  optionsWidth?: string;\r\n  refresh?: () => void;\r\n}\r\n\r\n","export default \"<ion-header [translucent]=\\\"true\\\">\\r\\n  <ion-toolbar color=\\\"primary\\\">\\r\\n    <ion-title>\\r\\n      Editar Agencia\\r\\n    </ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content [fullscreen]=\\\"true\\\">\\r\\n  <div class=\\\"body\\\">\\r\\n    <form [formGroup]=\\\"formAgency\\\" class=\\\"ion-padding\\\">\\r\\n      <div class=\\\"formulario\\\">\\r\\n      <ion-grid>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col sizeLg=\\\"3\\\" sizeMd=\\\"3\\\" sizeXs=\\\"5\\\">\\r\\n            <ion-label>Código Zip:</ion-label>\\r\\n          </ion-col>\\r\\n          <ion-col sizeLg=\\\"9\\\" sizeMd=\\\"9\\\" sizeSm=\\\"7\\\">\\r\\n            <ion-input type=\\\"number\\\" class=\\\"customInput\\\" formControlName=\\\"zipCode\\\"></ion-input>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col>\\r\\n            <p style=\\\"color:red;\\\" *ngIf=\\\"this.formAgency.get('zipCode').invalid&&formAgency.get('zipCode').touched\\\">\\r\\n              *Campo obligatorio. Debe introducir entre 2 y 21 caracteres.\\r\\n            </p>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col sizeLg=\\\"3\\\" sizeMd=\\\"3\\\" sizeXs=\\\"5\\\">\\r\\n            <ion-label>Dirección:</ion-label>\\r\\n          </ion-col>\\r\\n          <ion-col sizeLg=\\\"9\\\" sizeMd=\\\"9\\\" sizeSm=\\\"7\\\">\\r\\n            <ion-input class=\\\"customInput\\\" type=\\\"text\\\" formControlName=\\\"address\\\"></ion-input>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col>\\r\\n            <p style=\\\"color:red;\\\" *ngIf=\\\"this.formAgency.get('address').invalid&&formAgency.get('address').touched\\\">\\r\\n              *Campo obligatorio. Debe introducir entre 4 y 50 caracteres.\\r\\n            </p>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col sizeLg=\\\"3\\\" sizeMd=\\\"3\\\" sizeXs=\\\"5\\\">\\r\\n            <ion-label>Localidad:</ion-label>\\r\\n          </ion-col>\\r\\n          <ion-col sizeLg=\\\"9\\\" sizeMd=\\\"9\\\" sizeSm=\\\"7\\\">\\r\\n            <ion-input class=\\\"customInput\\\" type=\\\"text\\\" formControlName=\\\"location\\\"></ion-input>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col>\\r\\n            <p style=\\\"color:red;\\\" *ngIf=\\\"this.formAgency.get('location').invalid&&formAgency.get('location').touched\\\">\\r\\n              *Campo obligatorio. Debe introducir entre 4 y 50 caracteres.\\r\\n            </p>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col sizeLg=\\\"3\\\" sizeMd=\\\"3\\\" sizeXs=\\\"5\\\">\\r\\n            <ion-label>Teléfono:</ion-label>\\r\\n          </ion-col>\\r\\n          <ion-col sizeLg=\\\"9\\\" sizeMd=\\\"9\\\" sizeSm=\\\"7\\\">\\r\\n            <ion-input class=\\\"customInput\\\" type=\\\"number\\\" formControlName=\\\"phoneNumber\\\"></ion-input>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col>\\r\\n            <p style=\\\"color:red;\\\" *ngIf=\\\"this.formAgency.get('phoneNumber').invalid&&formAgency.get('phoneNumber').touched\\\">\\r\\n              *Campo obligatorio. Debe introducir un número de telefono de 9 dígitos exactos.\\r\\n            </p>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col sizeLg=\\\"3\\\" sizeMd=\\\"3\\\" sizeXs=\\\"5\\\">\\r\\n            <ion-label>Puntos:</ion-label>\\r\\n          </ion-col>\\r\\n          <ion-col sizeLg=\\\"9\\\" sizeMd=\\\"9\\\" sizeSm=\\\"7\\\">\\r\\n            <ion-input Disabled class=\\\"customInput\\\" type=\\\"number\\\" formControlName=\\\"points\\\"></ion-input>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col>\\r\\n            <p style=\\\"color:red;\\\" *ngIf=\\\"this.formAgency.get('points').invalid&&formAgency.get('points').touched\\\">\\r\\n              *Campo obligatorio.\\r\\n            </p>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col  sizeLg=\\\"3\\\" sizeMd=\\\"3\\\" sizeXs=\\\"5\\\">\\r\\n            Activa:\\r\\n          </ion-col>\\r\\n          <ion-col> \\r\\n            <ion-item  lines=\\\"none\\\">\\r\\n              No<ion-toggle [checked]=\\\"this.agency.active\\\"></ion-toggle>Si\\r\\n           </ion-item>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col sizeLg=\\\"3\\\" sizeMd=\\\"3\\\" sizeXs=\\\"5\\\">\\r\\n            <ion-label>Compañía de Seguros:</ion-label>\\r\\n          </ion-col>\\r\\n\\r\\n          <ion-col size=\\\"rem\\\">\\r\\n\\r\\n            <ion-button expand=\\\"block\\\" shape=\\\"round\\\" (click)=\\\"showPicker()\\\" >\\r\\n              {{this.insurance.cia_Name}}\\r\\n            </ion-button>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col>\\r\\n            <p style=\\\"color:red;\\\" *ngIf=\\\"this.errorCompany\\\">\\r\\n              *Campo obligatorio. Debe seleccionar una compañía de seguros.\\r\\n            </p>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n\\r\\n        <ion-row class=\\\"ion-align-items-center\\\">\\r\\n          <ion-col size=\\\"6\\\">\\r\\n            <ion-button expand=\\\"block\\\" shape=\\\"round\\\" class=\\\"button\\\" (click)=\\\"close()\\\">\\r\\n              Cancelar\\r\\n            </ion-button>\\r\\n          </ion-col>\\r\\n\\r\\n          <ion-col size=\\\"6\\\">\\r\\n            <ion-button (click)=\\\"edit()\\\" expand=\\\"block\\\" shape=\\\"round\\\" class=\\\"button\\\" [disabled]=\\\"this.formAgency.invalid||this.insurance==null\\\">\\r\\n              Actualizar\\r\\n            </ion-button>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n      </ion-grid>\\r\\n    </div>\\r\\n    </form>\\r\\n\\r\\n</div>\\r\\n</ion-content>\\r\\n\";"],"names":[],"sourceRoot":"webpack:///"}