"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2440],{2440:(M,p,l)=>{l.r(p),l.d(p,{ExchangeGiftListPageModule:()=>q});var x=l(6019),Z=l(9010),o=l(2651),m=l(8725),d=l(4762),G=l(8667),v=l(1549),e=l(865),E=l(922),T=l(9311);function y(s,h){1&s&&(e.TgZ(0,"div",41),e._UZ(1,"ion-icon",42),e.qZA())}function A(s,h){1&s&&(e.TgZ(0,"div",43),e._UZ(1,"ion-icon",44),e.qZA())}function C(s,h){if(1&s){const i=e.EpF();e.TgZ(0,"ion-row",26),e.TgZ(1,"ion-col",27),e.TgZ(2,"ion-text"),e.TgZ(3,"div",28),e.NdJ("click",function(){const r=e.CHM(i).$implicit;return e.oxw().edit(r)}),e._UZ(4,"ion-icon",29),e.qZA(),e.qZA(),e.qZA(),e.TgZ(5,"ion-col",27),e.TgZ(6,"ion-text"),e.TgZ(7,"div",30),e.NdJ("click",function(){const r=e.CHM(i).$implicit;return e.oxw().saw(r)}),e._UZ(8,"ion-icon",31),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"ion-col",27),e.TgZ(10,"ion-text"),e.TgZ(11,"div",32),e.NdJ("click",function(){const r=e.CHM(i).$implicit;return e.oxw().changeDeliveredAlert(r)}),e.TgZ(12,"ion-icon",33),e.NdJ("click",function(){const r=e.CHM(i).$implicit;return e.oxw().changeDeliveredAlert(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"ion-col",34),e.TgZ(14,"ion-text"),e._uU(15),e.qZA(),e.qZA(),e.TgZ(16,"ion-col",34),e.TgZ(17,"ion-text"),e._uU(18),e.qZA(),e.qZA(),e.TgZ(19,"ion-col",34),e.TgZ(20,"ion-text"),e._uU(21),e.qZA(),e.qZA(),e.TgZ(22,"ion-col",35),e.YNc(23,y,2,0,"div",36),e.YNc(24,A,2,0,"div",37),e.qZA(),e.TgZ(25,"ion-col",38),e.TgZ(26,"ion-text"),e.TgZ(27,"div",39),e.NdJ("click",function(){const r=e.CHM(i).$implicit;return e.oxw().mensagealerta(r)}),e._UZ(28,"ion-icon",40),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&s){const i=h.$implicit;e.Q6J("ngClass",h.index%2==0?"normal":"colored"),e.xp6(15),e.hij(" ",i.dateExchange," "),e.xp6(3),e.hij(" ",i.agency.myInsuranceCompany.cia_Name+" - "+i.agency.location," "),e.xp6(3),e.hij(" ",i.gift.name," "),e.xp6(2),e.Q6J("ngIf",i.delivered),e.xp6(1),e.Q6J("ngIf",!i.delivered)}}const b=[{path:"",component:(()=>{class s{constructor(i,t,n,r,c,u,a){this.exs=i,this.loading=t,this.toast=n,this.alerta=r,this.pt=c,this.modalCtrl=u,this.authS=a,this.exGifts=[],this.oldExGifts=[],this.exGiftsx=[]}ionViewDidEnter(){return(0,d.mG)(this,void 0,void 0,function*(){this.niTems=Math.ceil(this.pt.height()/20+10),yield this.cargaExGifts()})}edit(i){return(0,d.mG)(this,void 0,void 0,function*(){try{const t=yield this.modalCtrl.create({component:G.s,cssClass:"fullscreen",componentProps:{exchange:i}});yield t.present();const n=yield t.onDidDismiss();if(null!=n.data){let r=this.exGifts.indexOf(i);this.exGifts[r]=n.data.newExchange,this.oldExGifts.forEach(c=>{if(c.id==n.data.newExchange.id){let u=this.oldExGifts.indexOf(c);this.oldExGifts[u]=this.exGifts[r]}})}}catch(t){console.log(t)}})}setbyExGiftByStatus(i){return(0,d.mG)(this,void 0,void 0,function*(){this.searchChange()})}saw(i){return(0,d.mG)(this,void 0,void 0,function*(){try{const t=yield this.modalCtrl.create({component:v.i,componentProps:{exchangesaw:i}});yield t.present();const n=yield t.onDidDismiss();if(null!=n.data){let r=this.exGifts.indexOf(i);this.exGifts[r]=n.data.newExchange;let c=this.oldExGifts.indexOf(i);this.oldExGifts[c]=n.data.newExchange}}catch(t){console.log(t)}})}cargaExGifts(i){return(0,d.mG)(this,void 0,void 0,function*(){this.infinite&&(this.infinite.disabled=!1,this.oldInfinite=!1),i||(yield this.presentLoading()),this.exGifts=[],this.oldExGifts=[];try{this.exGifts=yield this.exs.getAllPaged(this.niTems,this.exGifts.length),this.exGifts=this.sortList(this.exGifts),this.oldExGifts=this.oldExGifts.concat(this.exGifts),this.exGiftsx=this.exGifts}catch(t){console.error(t),yield this.presentToast("Error cargando datos","danger","ban")}finally{i?i.target.complete():yield this.miLoading.dismiss()}})}borra(i){return(0,d.mG)(this,void 0,void 0,function*(){if(yield this.presentLoading(),yield this.exs.delete(i)){let n=this.exGifts.indexOf(i,0);n>-1&&this.exGifts.splice(n,1),this.oldExGifts.forEach(r=>{if(r.id==i.id){let c=this.oldExGifts.indexOf(r);this.oldExGifts.splice(c,1)}}),this.presentToast("Pedido eliminado correctamente.","success","checkmark-circle-outline")}else this.presentToast("Ha habido un error al intentar eliminar el pedido.","danger","ban");yield this.miLoading.dismiss()})}presentLoading(){return(0,d.mG)(this,void 0,void 0,function*(){this.miLoading=yield this.loading.create({message:""}),yield this.miLoading.present()})}presentToast(i,t,n){return(0,d.mG)(this,void 0,void 0,function*(){(yield this.toast.create({message:i,duration:2e3,color:t,icon:n})).present()})}mensagealerta(i){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alerta.create({header:"Eliminar",message:"\xbfDesea eliminar este Pedido?",buttons:[{text:"Eliminar",cssClass:"rojo",handler:()=>{this.borra(i)}},{text:"Cancelar",cssClass:"secondary",handler:n=>{}}]})).present()})}infiniteLoad(i){return(0,d.mG)(this,void 0,void 0,function*(){let t=[];this.infinite.disabled||(t=yield this.exs.getAllPaged(this.niTems,this.exGifts.length),t=this.sortList(t),this.exGifts=this.exGifts.concat(t),this.oldExGifts=this.oldExGifts.concat(t),t.length<30&&(this.infinite.disabled=!0,this.oldInfinite=!0)),this.infinite.complete()})}reset(i){return(0,d.mG)(this,void 0,void 0,function*(){this.infinite.disabled=!1,this.oldInfinite=!1,this.exGifts=[],this.oldExGifts=[],this.cargaExGifts(i)})}logout(){this.authS.logout()}onSearchChange(i){this.searchStr=i.detail.value}searchChange(){return(0,d.mG)(this,void 0,void 0,function*(){try{this.searchStr=this.sb.value;let i=new RegExp("^[ ]");if(this.searchStr.match(i))this.uts.presentToast("La b\xfasqueda no puede comenzar por espacios en blanco.","danger","ban");else{let t=[],n=[],r=this.select.value,c=[];this.exGifts=[];let u=this.searchStr.length;u>0?(yield this.presentLoading(),c=yield this.exs.getByDateFilter(this.searchStr),c.forEach(a=>{let f=!0;t.forEach(g=>{g.id==a.id&&(f=!1)}),f&&t.push(a)}),+this.searchStr>=0&&(c=yield this.exs.getByPoints(this.searchStr),c.forEach(a=>{let f=!0;t.forEach(g=>{g.id==a.id&&(f=!1)}),f&&t.push(a)})),c=yield this.exs.getByGiftName(this.searchStr),c.forEach(a=>{let f=!0;t.forEach(g=>{g.id==a.id&&(f=!1)}),f&&t.push(a)}),c=yield this.exs.getByAgencyUsername(this.searchStr),c.forEach(a=>{let f=!0;t.forEach(g=>{g.id==a.id&&(f=!1)}),f&&t.push(a)}),"true"==r?(t.forEach(a=>{a.delivered&&n.push(a)}),this.exGifts=n,this.exGifts=this.sortList(this.exGifts)):"false"==r?(t.forEach(a=>{a.delivered||n.push(a)}),this.exGifts=n,this.exGifts=this.sortList(this.exGifts)):(this.exGifts=t,this.exGifts=this.sortList(this.exGifts)),this.infinite.disabled=!1,yield this.miLoading.dismiss()):u<1&&(yield this.presentLoading(),"true"==r?(t=yield this.exs.getByDeliveredPaged(!0,9999,0),t.forEach(a=>{a.delivered&&n.push(a)}),this.exGifts=n,this.infinite.disabled=!0):"false"==r?(t=yield this.exs.getByDeliveredPaged(!1,9999,0),t.forEach(a=>{a.delivered||n.push(a)}),this.exGifts=n,this.infinite.disabled=!0):(this.exGifts=this.oldExGifts,this.infinite.disabled=this.oldInfinite),yield this.miLoading.dismiss())}}catch(i){this.uts.presentToast("Ha habido un error en su b\xfasqueda. Int\xe9ntlo de neuvo.","danger","ban")}})}changeDeliveredAlert(i){return(0,d.mG)(this,void 0,void 0,function*(){let t;t=i.delivered?"Pendiente":"Entregado",yield(yield this.alerta.create({header:"Cambio de estado de pedido.",message:"El estado de este pedido se cambiar\xe1 a "+t+", \xbfest\xe1 seguro que quiere continuar?",buttons:[{text:"Aceptar",cssClass:"secondary",handler:()=>{this.changeDelivered(i)}},{text:"Cancelar",cssClass:"rojo",handler:r=>{}}]})).present()})}changeDelivered(i){return(0,d.mG)(this,void 0,void 0,function*(){if(null!=i){let t;i.delivered=!i.delivered,t=i.delivered?"Entregado":"Pendiente";try{yield this.presentLoading(),null!=(i=yield this.exs.createOrUpdate(i))&&this.presentToast("Se ha cambiado el estado del pedido a "+t+".","success","checkmark-circle-outline"),yield this.miLoading.dismiss()}catch(n){console.log(n),this.presentToast("Ha habido un error al cambiar el estado del pedido.","danger","ban"),yield this.miLoading.dismiss()}}})}sortList(i){return null!=i&&i.length>1&&(i=i.sort((t,n)=>t.dateExchange>n.dateExchange?1:t.dateExchange<n.dateExchange?-1:t.id>n.id?1:t.id<n.id?-1:0)),i}}return s.\u0275fac=function(i){return new(i||s)(e.Y36(E.y),e.Y36(o.HT),e.Y36(o.yF),e.Y36(o.Br),e.Y36(o.t4),e.Y36(o.IN),e.Y36(T.e))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-exchange-gift-list"]],viewQuery:function(i,t){if(1&i&&(e.Gf(o.ju,5),e.Gf(o.t9,5),e.Gf(o.VI,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.infinite=n.first),e.iGM(n=e.CRH())&&(t.select=n.first),e.iGM(n=e.CRH())&&(t.sb=n.first)}},decls:49,vars:3,consts:[[3,"translucent"],["color","primary"],["slot","end",1,"icon-div-container",2,"margin-right","1%"],["title","Nuevo","routerLink","/tab-administrator/exchange-gift/create"],["slot","end",1,"icon-logout",2,"pointer-events","none","zoom","1.5","cursor","pointer","content","url(../../../../assets/icon/add-circle-outline.png)"],["title","Cerrar Sesi\xf3n",3,"click"],["slot","end","name","log-out-outline",1,"icon-logout",2,"pointer-events","none","zoom","1.7","cursor","pointer"],["sizeSm","9.5","sizeLg","9.5"],["placeholder","Encuentra el canjeo que est\xe1s buscando...","inputmode","text","type","text","debounce","1000","showCancelButton","always",3,"ionChange"],["sizeSm","2.5","sizeLg","2.5",1,"selector"],[2,"height","85%","margin-top","1.1%"],["interface","popover","multiple","false",3,"ionChange"],["value","true"],["value","false"],["value","all"],[1,"header-row"],["size","1.4",2,"border","0px !important"],["size","2.5",2,"border","0px !important"],["size","1",2,"border","0px !important"],[2,"background-color","white",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"body"],[1,"ion-text-center"],["style","border-left: 1px solid #4b4b4d;border-right: 1px solid #4b4b4d;","let","",3,"ngClass",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText",""],["let","",2,"border-left","1px solid #4b4b4d","border-right","1px solid #4b4b4d",3,"ngClass"],["size","0.5"],["title","Editar",2,"cursor","pointer",3,"click"],["name","pencil",1,"icon-c",2,"color","#22388c","cursor","pointer"],["title","Ver detalles",2,"cursor","pointer",3,"click"],["name","eye-outline",2,"color","#22388c","pointer-events","none"],["title","Cambiar estado",2,"cursor","pointer",3,"click"],["name","gift-outline",2,"color","#22388c","pointer-events","none",3,"click"],["size","2.5"],["size","2.6"],["title","Entregado",4,"ngIf"],["title","Pendiente",4,"ngIf"],["size","0.4"],["title","Eliminar",2,"cursor","pointer",3,"click"],["name","trash","color","danger",2,"pointer-events","none"],["title","Entregado"],["name","checkmark-circle","color","success",2,"pointer-events","none"],["title","Pendiente"],["name","close-circle","color","danger",2,"pointer-events","none"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header",0),e.TgZ(1,"ion-toolbar",1),e.TgZ(2,"ion-title"),e._uU(3,"Lista de Pedidos"),e.qZA(),e.TgZ(4,"ion-buttons",2),e.TgZ(5,"div",3),e._UZ(6,"ion-icon",4),e.qZA(),e.TgZ(7,"div",5),e.NdJ("click",function(){return t.logout()}),e._UZ(8,"ion-icon",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"ion-toolbar",1),e.TgZ(10,"ion-row"),e.TgZ(11,"ion-col",7),e.TgZ(12,"ion-searchbar",8),e.NdJ("ionChange",function(){return t.searchChange()}),e.qZA(),e.qZA(),e.TgZ(13,"ion-col",9),e.TgZ(14,"ion-item",10),e.TgZ(15,"ion-label"),e._uU(16,"Entregado:"),e.qZA(),e.TgZ(17,"ion-select",11),e.NdJ("ionChange",function(){return t.searchChange()}),e.TgZ(18,"ion-select-option",12),e._uU(19,"Si"),e.qZA(),e.TgZ(20,"ion-select-option",13),e._uU(21,"No"),e.qZA(),e.TgZ(22,"ion-select-option",14),e._uU(23,"Todos"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"ion-row",15),e.TgZ(25,"ion-col",16),e._UZ(26,"ion-text"),e.qZA(),e.TgZ(27,"ion-col",17),e.TgZ(28,"ion-text"),e._uU(29,"Fecha de Intercambio"),e.qZA(),e.qZA(),e.TgZ(30,"ion-col",17),e.TgZ(31,"ion-text"),e._uU(32,"Nombre de Agencia"),e.qZA(),e.qZA(),e.TgZ(33,"ion-col",17),e.TgZ(34,"ion-text"),e._uU(35,"Nombre de Regalo"),e.qZA(),e.qZA(),e.TgZ(36,"ion-col",17),e.TgZ(37,"ion-text"),e._uU(38,"Entregado"),e.qZA(),e.qZA(),e.TgZ(39,"ion-col",18),e._UZ(40,"ion-text"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(41,"ion-content",19),e.TgZ(42,"ion-refresher",20),e.NdJ("ionRefresh",function(r){return t.reset(r)}),e._UZ(43,"ion-refresher-content"),e.qZA(),e.TgZ(44,"div",21),e.TgZ(45,"ion-grid",22),e.YNc(46,C,29,6,"ion-row",23),e.qZA(),e.TgZ(47,"ion-infinite-scroll",24),e.NdJ("ionInfinite",function(r){return t.infiniteLoad(r)}),e._UZ(48,"ion-infinite-scroll-content",25),e.qZA(),e.qZA(),e.qZA()),2&i&&(e.Q6J("translucent",!1),e.xp6(41),e.Q6J("fullscreen",!0),e.xp6(5),e.Q6J("ngForOf",t.exGifts))},directives:[o.Gu,o.sr,o.wd,o.Sm,o.YI,m.rH,o.gu,o.Nd,o.wI,o.VI,o.j9,o.Ie,o.Q$,o.t9,o.QI,o.n0,o.yW,o.W2,o.nJ,o.Wo,o.jY,x.sg,o.ju,o.MB,x.mk,x.O5],styles:['ion-col[_ngcontent-%COMP%]{border-bottom:1px solid #4b4b4d}ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#4b4b4d!important}.header-row[_ngcontent-%COMP%]{border-radius:0%;border:0px}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{text-align:center}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:#fff!important;font-size:1.2rem;text-align:center}.row[_ngcontent-%COMP%]{color:#fff;font-size:1.1rem}.body[_ngcontent-%COMP%]{background-color:#fff;font-family:"Roboto",sans-serif;color:#4b4b4d}.icon-c[_ngcontent-%COMP%]{pointer-events:none}']}),s})(),children:[{path:"exchange-gif-update",loadChildren:()=>l.e(8592).then(l.bind(l,9252)).then(s=>s.ExchangeGifUpdatePageModule)},{path:"exchange-gif-saw",loadChildren:()=>l.e(8592).then(l.bind(l,6166)).then(s=>s.ExchangeGifSawPageModule)},{path:"exchange-gif-create",loadChildren:()=>l.e(8592).then(l.bind(l,2610)).then(s=>s.ExchangeGifCreatePageModule)}]}];let P=(()=>{class s{}return s.\u0275fac=function(i){return new(i||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[m.Bz.forChild(b)],m.Bz]}),s})();var L=l(8816),_=l(371);let q=(()=>{class s{}return s.\u0275fac=function(i){return new(i||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[_.f],imports:[[x.ez,Z.u5,o.Pc,P,Z.UX,L.h]]}),s})()}}]);